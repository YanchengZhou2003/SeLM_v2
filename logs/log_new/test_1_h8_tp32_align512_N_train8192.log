分词器已加载，词汇表大小: 8192
Before CTE Training: train eu loss: 0.6827309727668762, eval eu loss: 5.025336265563965
Before CTE Training: train eu acc: 1.0, eval eu acc: 0.2396240234375
epoch   0 summary: train_cos_loss : 0.030404, train_cro_loss : 9.2392, train_tot_loss : 0.1225, vocab_cos_loss : 0.004419, 
train loss: 8.5531, accuracy: 0.0171
epoch   1 summary: train_cos_loss : 0.030798, train_cro_loss : 8.5247, train_tot_loss : 0.1157, vocab_cos_loss : 0.004322, 
epoch   2 summary: train_cos_loss : 0.030509, train_cro_loss : 7.8827, train_tot_loss : 0.1090, vocab_cos_loss : 0.004249, 
epoch   3 summary: train_cos_loss : 0.030088, train_cro_loss : 7.3131, train_tot_loss : 0.1029, vocab_cos_loss : 0.004278, 
epoch   4 summary: train_cos_loss : 0.029779, train_cro_loss : 6.7825, train_tot_loss : 0.0973, vocab_cos_loss : 0.004369, 
epoch   5 summary: train_cos_loss : 0.030414, train_cro_loss : 6.2975, train_tot_loss : 0.0931, vocab_cos_loss : 0.004297, 
epoch   6 summary: train_cos_loss : 0.029436, train_cro_loss : 5.8072, train_tot_loss : 0.0872, vocab_cos_loss : 0.004110, 
epoch   7 summary: train_cos_loss : 0.028874, train_cro_loss : 5.3139, train_tot_loss : 0.0817, vocab_cos_loss : 0.004104, 
epoch   8 summary: train_cos_loss : 0.029413, train_cro_loss : 4.9022, train_tot_loss : 0.0781, vocab_cos_loss : 0.003890, 
epoch   9 summary: train_cos_loss : 0.029333, train_cro_loss : 4.4959, train_tot_loss : 0.0740, vocab_cos_loss : 0.003868, 
epoch  10 summary: train_cos_loss : 0.029139, train_cro_loss : 4.1572, train_tot_loss : 0.0704, vocab_cos_loss : 0.003854, 
train loss: 3.8646, accuracy: 0.9106
epoch  11 summary: train_cos_loss : 0.029597, train_cro_loss : 3.8481, train_tot_loss : 0.0678, vocab_cos_loss : 0.003618, 
epoch  12 summary: train_cos_loss : 0.029125, train_cro_loss : 3.5654, train_tot_loss : 0.0645, vocab_cos_loss : 0.003412, 
epoch  13 summary: train_cos_loss : 0.029085, train_cro_loss : 3.2575, train_tot_loss : 0.0614, vocab_cos_loss : 0.003234, 
epoch  14 summary: train_cos_loss : 0.028645, train_cro_loss : 3.0419, train_tot_loss : 0.0588, vocab_cos_loss : 0.003120, 
epoch  15 summary: train_cos_loss : 0.029495, train_cro_loss : 2.8530, train_tot_loss : 0.0577, vocab_cos_loss : 0.002960, 
epoch  16 summary: train_cos_loss : 0.029222, train_cro_loss : 2.6492, train_tot_loss : 0.0554, vocab_cos_loss : 0.002709, 
epoch  17 summary: train_cos_loss : 0.028280, train_cro_loss : 2.4950, train_tot_loss : 0.0529, vocab_cos_loss : 0.002753, 
epoch  18 summary: train_cos_loss : 0.028357, train_cro_loss : 2.3535, train_tot_loss : 0.0516, vocab_cos_loss : 0.002361, 
epoch  19 summary: train_cos_loss : 0.028857, train_cro_loss : 2.3309, train_tot_loss : 0.0519, vocab_cos_loss : 0.002392, 
epoch  20 summary: train_cos_loss : 0.028686, train_cro_loss : 2.4121, train_tot_loss : 0.0525, vocab_cos_loss : 0.002289, 
train loss: 2.1866, accuracy: 0.9841
epoch  21 summary: train_cos_loss : 0.028814, train_cro_loss : 2.1592, train_tot_loss : 0.0501, vocab_cos_loss : 0.002114, 
epoch  22 summary: train_cos_loss : 0.028841, train_cro_loss : 1.9988, train_tot_loss : 0.0485, vocab_cos_loss : 0.001954, 
epoch  23 summary: train_cos_loss : 0.028843, train_cro_loss : 1.8223, train_tot_loss : 0.0468, vocab_cos_loss : 0.001812, 
epoch  24 summary: train_cos_loss : 0.028817, train_cro_loss : 1.7120, train_tot_loss : 0.0456, vocab_cos_loss : 0.001684, 
epoch  25 summary: train_cos_loss : 0.028744, train_cro_loss : 1.5704, train_tot_loss : 0.0442, vocab_cos_loss : 0.001565, 
epoch  26 summary: train_cos_loss : 0.028681, train_cro_loss : 1.4564, train_tot_loss : 0.0430, vocab_cos_loss : 0.001455, 
epoch  27 summary: train_cos_loss : 0.028594, train_cro_loss : 1.3761, train_tot_loss : 0.0421, vocab_cos_loss : 0.001356, 
epoch  28 summary: train_cos_loss : 0.028518, train_cro_loss : 1.2945, train_tot_loss : 0.0412, vocab_cos_loss : 0.001268, 
epoch  29 summary: train_cos_loss : 0.028430, train_cro_loss : 1.1997, train_tot_loss : 0.0401, vocab_cos_loss : 0.001194, 
epoch  30 summary: train_cos_loss : 0.028485, train_cro_loss : 1.1509, train_tot_loss : 0.0397, vocab_cos_loss : 0.001163, 
train loss: 1.1366, accuracy: 0.9967
epoch  31 summary: train_cos_loss : 0.028426, train_cro_loss : 1.1209, train_tot_loss : 0.0394, vocab_cos_loss : 0.001094, 
epoch  32 summary: train_cos_loss : 0.028344, train_cro_loss : 1.0817, train_tot_loss : 0.0389, vocab_cos_loss : 0.001032, 
epoch  33 summary: train_cos_loss : 0.028262, train_cro_loss : 1.0412, train_tot_loss : 0.0384, vocab_cos_loss : 0.000974, 
epoch  34 summary: train_cos_loss : 0.028180, train_cro_loss : 1.0011, train_tot_loss : 0.0379, vocab_cos_loss : 0.000925, 
epoch  35 summary: train_cos_loss : 0.028094, train_cro_loss : 0.9893, train_tot_loss : 0.0377, vocab_cos_loss : 0.000878, 
epoch  36 summary: train_cos_loss : 0.027998, train_cro_loss : 0.9509, train_tot_loss : 0.0372, vocab_cos_loss : 0.000839, 
epoch  37 summary: train_cos_loss : 0.027927, train_cro_loss : 0.9243, train_tot_loss : 0.0369, vocab_cos_loss : 0.000803, 
epoch  38 summary: train_cos_loss : 0.027848, train_cro_loss : 0.8976, train_tot_loss : 0.0365, vocab_cos_loss : 0.000769, 
epoch  39 summary: train_cos_loss : 0.027754, train_cro_loss : 0.8653, train_tot_loss : 0.0361, vocab_cos_loss : 0.000744, 
epoch  40 summary: train_cos_loss : 0.027723, train_cro_loss : 0.8363, train_tot_loss : 0.0358, vocab_cos_loss : 0.000758, 
train loss: 0.8433, accuracy: 0.9978
epoch  41 summary: train_cos_loss : 0.027638, train_cro_loss : 0.8269, train_tot_loss : 0.0356, vocab_cos_loss : 0.000733, 
epoch  42 summary: train_cos_loss : 0.027539, train_cro_loss : 0.8101, train_tot_loss : 0.0354, vocab_cos_loss : 0.000712, 
epoch  43 summary: train_cos_loss : 0.027473, train_cro_loss : 0.8078, train_tot_loss : 0.0353, vocab_cos_loss : 0.000695, 
epoch  44 summary: train_cos_loss : 0.027420, train_cro_loss : 0.8054, train_tot_loss : 0.0352, vocab_cos_loss : 0.000678, 
epoch  45 summary: train_cos_loss : 0.027338, train_cro_loss : 0.7842, train_tot_loss : 0.0349, vocab_cos_loss : 0.000662, 
epoch  46 summary: train_cos_loss : 0.027274, train_cro_loss : 0.7889, train_tot_loss : 0.0349, vocab_cos_loss : 0.000647, 
epoch  47 summary: train_cos_loss : 0.027206, train_cro_loss : 0.7640, train_tot_loss : 0.0346, vocab_cos_loss : 0.000633, 
epoch  48 summary: train_cos_loss : 0.027126, train_cro_loss : 0.7484, train_tot_loss : 0.0343, vocab_cos_loss : 0.000622, 
epoch  49 summary: train_cos_loss : 0.027061, train_cro_loss : 0.7470, train_tot_loss : 0.0343, vocab_cos_loss : 0.000610, 
epoch  50 summary: train_cos_loss : 0.027177, train_cro_loss : 0.7259, train_tot_loss : 0.0342, vocab_cos_loss : 0.000632, 
train loss: 0.7549, accuracy: 0.9948
epoch  51 summary: train_cos_loss : 0.027121, train_cro_loss : 0.7269, train_tot_loss : 0.0341, vocab_cos_loss : 0.000622, 
epoch  52 summary: train_cos_loss : 0.027047, train_cro_loss : 0.7222, train_tot_loss : 0.0340, vocab_cos_loss : 0.000612, 
epoch  53 summary: train_cos_loss : 0.026983, train_cro_loss : 0.7138, train_tot_loss : 0.0339, vocab_cos_loss : 0.000605, 
epoch  54 summary: train_cos_loss : 0.026925, train_cro_loss : 0.7147, train_tot_loss : 0.0338, vocab_cos_loss : 0.000596, 
epoch  55 summary: train_cos_loss : 0.026881, train_cro_loss : 0.7128, train_tot_loss : 0.0337, vocab_cos_loss : 0.000586, 
epoch  56 summary: train_cos_loss : 0.026808, train_cro_loss : 0.7172, train_tot_loss : 0.0337, vocab_cos_loss : 0.000577, 
epoch  57 summary: train_cos_loss : 0.026774, train_cro_loss : 0.7145, train_tot_loss : 0.0337, vocab_cos_loss : 0.000570, 
epoch  58 summary: train_cos_loss : 0.026695, train_cro_loss : 0.6952, train_tot_loss : 0.0334, vocab_cos_loss : 0.000565, 
epoch  59 summary: train_cos_loss : 0.026658, train_cro_loss : 0.6830, train_tot_loss : 0.0332, vocab_cos_loss : 0.000560, 
epoch  60 summary: train_cos_loss : 0.026625, train_cro_loss : 0.6598, train_tot_loss : 0.0330, vocab_cos_loss : 0.000588, 
train loss: 0.6839, accuracy: 0.9976
epoch  61 summary: train_cos_loss : 0.026586, train_cro_loss : 0.6585, train_tot_loss : 0.0329, vocab_cos_loss : 0.000583, 
epoch  62 summary: train_cos_loss : 0.026512, train_cro_loss : 0.6401, train_tot_loss : 0.0326, vocab_cos_loss : 0.000578, 
epoch  63 summary: train_cos_loss : 0.026468, train_cro_loss : 0.6328, train_tot_loss : 0.0325, vocab_cos_loss : 0.000571, 
epoch  64 summary: train_cos_loss : 0.026429, train_cro_loss : 0.6542, train_tot_loss : 0.0327, vocab_cos_loss : 0.000568, 
epoch  65 summary: train_cos_loss : 0.026417, train_cro_loss : 0.6291, train_tot_loss : 0.0324, vocab_cos_loss : 0.000563, 
epoch  66 summary: train_cos_loss : 0.026371, train_cro_loss : 0.6301, train_tot_loss : 0.0324, vocab_cos_loss : 0.000560, 
epoch  67 summary: train_cos_loss : 0.026346, train_cro_loss : 0.6272, train_tot_loss : 0.0324, vocab_cos_loss : 0.000556, 
epoch  68 summary: train_cos_loss : 0.026309, train_cro_loss : 0.6119, train_tot_loss : 0.0322, vocab_cos_loss : 0.000553, 
epoch  69 summary: train_cos_loss : 0.026301, train_cro_loss : 0.6153, train_tot_loss : 0.0322, vocab_cos_loss : 0.000550, 
epoch  70 summary: train_cos_loss : 0.026382, train_cro_loss : 0.6158, train_tot_loss : 0.0323, vocab_cos_loss : 0.000580, 
train loss: 0.6317, accuracy: 0.9977
epoch  71 summary: train_cos_loss : 0.026358, train_cro_loss : 0.6105, train_tot_loss : 0.0322, vocab_cos_loss : 0.000576, 
epoch  72 summary: train_cos_loss : 0.026343, train_cro_loss : 0.6108, train_tot_loss : 0.0322, vocab_cos_loss : 0.000573, 
epoch  73 summary: train_cos_loss : 0.026310, train_cro_loss : 0.6109, train_tot_loss : 0.0322, vocab_cos_loss : 0.000569, 
epoch  74 summary: train_cos_loss : 0.026301, train_cro_loss : 0.6148, train_tot_loss : 0.0322, vocab_cos_loss : 0.000566, 
epoch  75 summary: train_cos_loss : 0.026291, train_cro_loss : 0.6114, train_tot_loss : 0.0321, vocab_cos_loss : 0.000564, 
epoch  76 summary: train_cos_loss : 0.026281, train_cro_loss : 0.6311, train_tot_loss : 0.0323, vocab_cos_loss : 0.000560, 
epoch  77 summary: train_cos_loss : 0.026278, train_cro_loss : 0.6093, train_tot_loss : 0.0321, vocab_cos_loss : 0.000558, 
epoch  78 summary: train_cos_loss : 0.026251, train_cro_loss : 0.6153, train_tot_loss : 0.0321, vocab_cos_loss : 0.000554, 
epoch  79 summary: train_cos_loss : 0.026233, train_cro_loss : 0.5977, train_tot_loss : 0.0319, vocab_cos_loss : 0.000554, 
epoch  80 summary: train_cos_loss : 0.026346, train_cro_loss : 0.5803, train_tot_loss : 0.0319, vocab_cos_loss : 0.000585, 
train loss: 0.6162, accuracy: 0.9966
epoch  81 summary: train_cos_loss : 0.026317, train_cro_loss : 0.5785, train_tot_loss : 0.0318, vocab_cos_loss : 0.000583, 
epoch  82 summary: train_cos_loss : 0.026299, train_cro_loss : 0.5823, train_tot_loss : 0.0319, vocab_cos_loss : 0.000580, 
epoch  83 summary: train_cos_loss : 0.026295, train_cro_loss : 0.5740, train_tot_loss : 0.0318, vocab_cos_loss : 0.000577, 
epoch  84 summary: train_cos_loss : 0.026279, train_cro_loss : 0.5831, train_tot_loss : 0.0318, vocab_cos_loss : 0.000574, 
epoch  85 summary: train_cos_loss : 0.026252, train_cro_loss : 0.5744, train_tot_loss : 0.0317, vocab_cos_loss : 0.000572, 
epoch  86 summary: train_cos_loss : 0.026253, train_cro_loss : 0.5666, train_tot_loss : 0.0317, vocab_cos_loss : 0.000569, 
epoch  87 summary: train_cos_loss : 0.026232, train_cro_loss : 0.5518, train_tot_loss : 0.0315, vocab_cos_loss : 0.000568, 
epoch  88 summary: train_cos_loss : 0.026215, train_cro_loss : 0.5577, train_tot_loss : 0.0315, vocab_cos_loss : 0.000566, 
epoch  89 summary: train_cos_loss : 0.026211, train_cro_loss : 0.5377, train_tot_loss : 0.0313, vocab_cos_loss : 0.000563, 
epoch  90 summary: train_cos_loss : 0.026272, train_cro_loss : 0.5483, train_tot_loss : 0.0315, vocab_cos_loss : 0.000590, 
train loss: 0.5868, accuracy: 0.9957
epoch  91 summary: train_cos_loss : 0.026247, train_cro_loss : 0.5562, train_tot_loss : 0.0315, vocab_cos_loss : 0.000586, 
epoch  92 summary: train_cos_loss : 0.026224, train_cro_loss : 0.5591, train_tot_loss : 0.0316, vocab_cos_loss : 0.000579, 
epoch  93 summary: train_cos_loss : 0.026211, train_cro_loss : 0.5595, train_tot_loss : 0.0315, vocab_cos_loss : 0.000576, 
epoch  94 summary: train_cos_loss : 0.026191, train_cro_loss : 0.5676, train_tot_loss : 0.0316, vocab_cos_loss : 0.000575, 
epoch  95 summary: train_cos_loss : 0.026176, train_cro_loss : 0.5540, train_tot_loss : 0.0315, vocab_cos_loss : 0.000572, 
epoch  96 summary: train_cos_loss : 0.026167, train_cro_loss : 0.5489, train_tot_loss : 0.0314, vocab_cos_loss : 0.000570, 
epoch  97 summary: train_cos_loss : 0.026157, train_cro_loss : 0.5402, train_tot_loss : 0.0313, vocab_cos_loss : 0.000567, 
epoch  98 summary: train_cos_loss : 0.026136, train_cro_loss : 0.5537, train_tot_loss : 0.0314, vocab_cos_loss : 0.000567, 
epoch  99 summary: train_cos_loss : 0.026132, train_cro_loss : 0.5425, train_tot_loss : 0.0313, vocab_cos_loss : 0.000564, 
epoch 100 summary: train_cos_loss : 0.026208, train_cro_loss : 0.5455, train_tot_loss : 0.0314, vocab_cos_loss : 0.000593, 
train loss: 0.5927, accuracy: 0.9945
epoch 101 summary: train_cos_loss : 0.026212, train_cro_loss : 0.5548, train_tot_loss : 0.0315, vocab_cos_loss : 0.000589, 
epoch 102 summary: train_cos_loss : 0.026191, train_cro_loss : 0.5683, train_tot_loss : 0.0316, vocab_cos_loss : 0.000585, 
epoch 103 summary: train_cos_loss : 0.026179, train_cro_loss : 0.5539, train_tot_loss : 0.0315, vocab_cos_loss : 0.000580, 
epoch 104 summary: train_cos_loss : 0.026181, train_cro_loss : 0.5768, train_tot_loss : 0.0317, vocab_cos_loss : 0.000575, 
epoch 105 summary: train_cos_loss : 0.026160, train_cro_loss : 0.5524, train_tot_loss : 0.0314, vocab_cos_loss : 0.000575, 
epoch 106 summary: train_cos_loss : 0.026126, train_cro_loss : 0.5673, train_tot_loss : 0.0315, vocab_cos_loss : 0.000574, 
epoch 107 summary: train_cos_loss : 0.026103, train_cro_loss : 0.5746, train_tot_loss : 0.0316, vocab_cos_loss : 0.000573, 
epoch 108 summary: train_cos_loss : 0.026072, train_cro_loss : 0.5729, train_tot_loss : 0.0315, vocab_cos_loss : 0.000572, 
epoch 109 summary: train_cos_loss : 0.026035, train_cro_loss : 0.5461, train_tot_loss : 0.0312, vocab_cos_loss : 0.000572, 
epoch 110 summary: train_cos_loss : 0.026102, train_cro_loss : 0.5393, train_tot_loss : 0.0312, vocab_cos_loss : 0.000604, 
train loss: 0.5781, accuracy: 0.9939
epoch 111 summary: train_cos_loss : 0.026072, train_cro_loss : 0.5399, train_tot_loss : 0.0312, vocab_cos_loss : 0.000601, 
epoch 112 summary: train_cos_loss : 0.026011, train_cro_loss : 0.5532, train_tot_loss : 0.0313, vocab_cos_loss : 0.000598, 
epoch 113 summary: train_cos_loss : 0.025953, train_cro_loss : 0.5548, train_tot_loss : 0.0312, vocab_cos_loss : 0.000596, 
epoch 114 summary: train_cos_loss : 0.025929, train_cro_loss : 0.5359, train_tot_loss : 0.0310, vocab_cos_loss : 0.000594, 
epoch 115 summary: train_cos_loss : 0.025897, train_cro_loss : 0.5441, train_tot_loss : 0.0311, vocab_cos_loss : 0.000593, 
epoch 116 summary: train_cos_loss : 0.025851, train_cro_loss : 0.5305, train_tot_loss : 0.0309, vocab_cos_loss : 0.000593, 
epoch 117 summary: train_cos_loss : 0.025819, train_cro_loss : 0.5170, train_tot_loss : 0.0307, vocab_cos_loss : 0.000594, 
epoch 118 summary: train_cos_loss : 0.025813, train_cro_loss : 0.5254, train_tot_loss : 0.0308, vocab_cos_loss : 0.000594, 
epoch 119 summary: train_cos_loss : 0.025796, train_cro_loss : 0.5161, train_tot_loss : 0.0307, vocab_cos_loss : 0.000592, 
epoch 120 summary: train_cos_loss : 0.025855, train_cro_loss : 0.5078, train_tot_loss : 0.0307, vocab_cos_loss : 0.000623, 
train loss: 0.5795, accuracy: 0.9900
epoch 121 summary: train_cos_loss : 0.025829, train_cro_loss : 0.5437, train_tot_loss : 0.0310, vocab_cos_loss : 0.000620, 
epoch 122 summary: train_cos_loss : 0.025820, train_cro_loss : 0.5265, train_tot_loss : 0.0308, vocab_cos_loss : 0.000615, 
epoch 123 summary: train_cos_loss : 0.025778, train_cro_loss : 0.5269, train_tot_loss : 0.0308, vocab_cos_loss : 0.000614, 
epoch 124 summary: train_cos_loss : 0.025768, train_cro_loss : 0.5208, train_tot_loss : 0.0307, vocab_cos_loss : 0.000611, 
epoch 125 summary: train_cos_loss : 0.025749, train_cro_loss : 0.5472, train_tot_loss : 0.0310, vocab_cos_loss : 0.000611, 
epoch 126 summary: train_cos_loss : 0.025732, train_cro_loss : 0.5653, train_tot_loss : 0.0311, vocab_cos_loss : 0.000613, 
epoch 127 summary: train_cos_loss : 0.025687, train_cro_loss : 0.5526, train_tot_loss : 0.0310, vocab_cos_loss : 0.000613, 
epoch 128 summary: train_cos_loss : 0.025678, train_cro_loss : 0.5518, train_tot_loss : 0.0309, vocab_cos_loss : 0.000612, 
epoch 129 summary: train_cos_loss : 0.025664, train_cro_loss : 0.5390, train_tot_loss : 0.0308, vocab_cos_loss : 0.000611, 
epoch 130 summary: train_cos_loss : 0.025740, train_cro_loss : 0.5344, train_tot_loss : 0.0308, vocab_cos_loss : 0.000643, 
train loss: 0.5619, accuracy: 0.9926
epoch 131 summary: train_cos_loss : 0.025744, train_cro_loss : 0.5178, train_tot_loss : 0.0307, vocab_cos_loss : 0.000637, 
epoch 132 summary: train_cos_loss : 0.025737, train_cro_loss : 0.5325, train_tot_loss : 0.0308, vocab_cos_loss : 0.000633, 
epoch 133 summary: train_cos_loss : 0.025737, train_cro_loss : 0.5225, train_tot_loss : 0.0307, vocab_cos_loss : 0.000629, 
epoch 134 summary: train_cos_loss : 0.025727, train_cro_loss : 0.5271, train_tot_loss : 0.0307, vocab_cos_loss : 0.000626, 
epoch 135 summary: train_cos_loss : 0.025704, train_cro_loss : 0.5302, train_tot_loss : 0.0307, vocab_cos_loss : 0.000625, 
epoch 136 summary: train_cos_loss : 0.025709, train_cro_loss : 0.5370, train_tot_loss : 0.0308, vocab_cos_loss : 0.000622, 
epoch 137 summary: train_cos_loss : 0.025721, train_cro_loss : 0.5289, train_tot_loss : 0.0308, vocab_cos_loss : 0.000616, 
epoch 138 summary: train_cos_loss : 0.025710, train_cro_loss : 0.5575, train_tot_loss : 0.0310, vocab_cos_loss : 0.000611, 
epoch 139 summary: train_cos_loss : 0.025704, train_cro_loss : 0.5310, train_tot_loss : 0.0308, vocab_cos_loss : 0.000605, 
epoch 140 summary: train_cos_loss : 0.025791, train_cro_loss : 0.5057, train_tot_loss : 0.0306, vocab_cos_loss : 0.000633, 
train loss: 0.5389, accuracy: 0.9943
epoch 141 summary: train_cos_loss : 0.025777, train_cro_loss : 0.5094, train_tot_loss : 0.0306, vocab_cos_loss : 0.000629, 
epoch 142 summary: train_cos_loss : 0.025749, train_cro_loss : 0.5284, train_tot_loss : 0.0308, vocab_cos_loss : 0.000626, 
epoch 143 summary: train_cos_loss : 0.025758, train_cro_loss : 0.5488, train_tot_loss : 0.0310, vocab_cos_loss : 0.000621, 
epoch 144 summary: train_cos_loss : 0.025751, train_cro_loss : 0.5508, train_tot_loss : 0.0310, vocab_cos_loss : 0.000615, 
epoch 145 summary: train_cos_loss : 0.025717, train_cro_loss : 0.5551, train_tot_loss : 0.0310, vocab_cos_loss : 0.000609, 
epoch 146 summary: train_cos_loss : 0.025727, train_cro_loss : 0.5465, train_tot_loss : 0.0309, vocab_cos_loss : 0.000601, 
epoch 147 summary: train_cos_loss : 0.025711, train_cro_loss : 0.5395, train_tot_loss : 0.0308, vocab_cos_loss : 0.000598, 
epoch 148 summary: train_cos_loss : 0.025697, train_cro_loss : 0.5445, train_tot_loss : 0.0309, vocab_cos_loss : 0.000592, 
epoch 149 summary: train_cos_loss : 0.025676, train_cro_loss : 0.5478, train_tot_loss : 0.0309, vocab_cos_loss : 0.000590, 
train loss: 0.5669, accuracy: 0.9913
all                        1343341.972ms
all_epoch                  1338503.607ms
all_preparation               4838.339ms
all_preparation_2             4835.963ms
all_preparation_3                2.345ms
epoch                         8242.377ms
epoch_pos_train                  5.457ms
epoch_preparation                1.004ms
epoch_train                   8207.283ms
epoch_valid                     27.924ms
----------------------------------------
all                        1343341.972ms
  all_epoch             99.64%
  all_preparation        0.36%
all_preparation               4838.339ms
  all_preparation_2     99.95%
  all_preparation_3      0.05%
epoch                      1236356.570ms
  epoch_train           99.57%
  epoch_valid            0.34%
  epoch_pos_train        0.07%
  epoch_preparation      0.01%
epoch   0 summary: valid_cos_loss : 0.020985, 
valid loss: 8.9051, accuracy: 0.0033
epoch   1 summary: valid_cos_loss : 0.019904, 
epoch   2 summary: valid_cos_loss : 0.018427, 
epoch   3 summary: valid_cos_loss : 0.017988, 
epoch   4 summary: valid_cos_loss : 0.016981, 
epoch   5 summary: valid_cos_loss : 0.016289, 
epoch   6 summary: valid_cos_loss : 0.015068, 
epoch   7 summary: valid_cos_loss : 0.014344, 
epoch   8 summary: valid_cos_loss : 0.013500, 
Traceback (most recent call last):
  File "/data/gc/anaconda3/envs/lm/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/data/gc/anaconda3/envs/lm/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/data3/gc/SeLM_v2/src/gpt.py", line 383, in <module>
    train_cte(cache_ckpt, gpt_ckpt, N_train, N_valid)
  File "/data/gc/anaconda3/envs/lm/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data3/gc/SeLM_v2/src/gpt.py", line 361, in train_cte
    cte.test_time_train_all(
  File "/data3/gc/SeLM_v2/src/gettime.py", line 118, in wrapper
    return fn(*args, **kwargs)
  File "/data3/gc/SeLM_v2/src/cte.py", line 830, in test_time_train_all
    self.epoch_barrier.wait()          # 第二阶段：整合数据
  File "/data/gc/anaconda3/envs/lm/lib/python3.10/threading.py", line 668, in wait
    self._wait(timeout)
  File "/data/gc/anaconda3/envs/lm/lib/python3.10/threading.py", line 703, in _wait
    if not self._cond.wait_for(lambda : self._state != 0, timeout):
  File "/data/gc/anaconda3/envs/lm/lib/python3.10/threading.py", line 355, in wait_for
    self.wait(waittime)
  File "/data/gc/anaconda3/envs/lm/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt
Exception ignored in: <module 'threading' from '/data/gc/anaconda3/envs/lm/lib/python3.10/threading.py'>
Traceback (most recent call last):
  File "/data/gc/anaconda3/envs/lm/lib/python3.10/threading.py", line 1567, in _shutdown
    lock.acquire()
KeyboardInterrupt: 
all_preparation                 13.991ms
all_preparation_2               11.990ms
all_preparation_3                1.986ms
epoch                         2036.260ms
epoch_pos_train                  4.939ms
epoch_preparation                0.760ms
epoch_train                   2001.372ms
epoch_valid                     28.807ms
----------------------------------------
all                              0.000ms
all_preparation                 13.991ms
  all_preparation_2     85.70%
  all_preparation_3     14.20%
epoch                        18326.341ms
  epoch_train           98.29%
  epoch_valid            1.41%
  epoch_pos_train        0.24%
  epoch_preparation      0.04%
