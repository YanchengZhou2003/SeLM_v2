分词器已加载，词汇表大小: 8192
Before CTE Training: train eu loss: 0.6827309727668762, eval eu loss: 5.025336265563965
Before CTE Training: train eu acc: 1.0, eval eu acc: 0.2396240234375
epoch   0 summary: train_cos_loss : 0.029991, train_cro_loss : 8.5781, train_tot_loss : 0.1155, vocab_cos_loss : 0.004158, 
train loss: 8.5183, accuracy: 0.1746
epoch   1 summary: train_cos_loss : 0.028849, train_cro_loss : 7.7858, train_tot_loss : 0.1064, vocab_cos_loss : 0.004204, 
epoch   2 summary: train_cos_loss : 0.028654, train_cro_loss : 6.4460, train_tot_loss : 0.0928, vocab_cos_loss : 0.003875, 
Traceback (most recent call last):
  File "/data/gc/anaconda3/envs/lm/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/data/gc/anaconda3/envs/lm/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/data3/gc/SeLM_v2/src/gpt.py", line 383, in <module>
    train_cte(cache_ckpt, gpt_ckpt, N_train, N_valid)
  File "/data/gc/anaconda3/envs/lm/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data3/gc/SeLM_v2/src/gpt.py", line 357, in train_cte
    cte.train_all(
  File "/data3/gc/SeLM_v2/src/gettime.py", line 118, in wrapper
    return fn(*args, **kwargs)
  File "/data3/gc/SeLM_v2/src/cte.py", line 705, in train_all
    self.epoch_barrier.wait()          # 第二阶段：train_vocab        
  File "/data/gc/anaconda3/envs/lm/lib/python3.10/threading.py", line 668, in wait
    self._wait(timeout)
  File "/data/gc/anaconda3/envs/lm/lib/python3.10/threading.py", line 703, in _wait
    if not self._cond.wait_for(lambda : self._state != 0, timeout):
  File "/data/gc/anaconda3/envs/lm/lib/python3.10/threading.py", line 355, in wait_for
    self.wait(waittime)
  File "/data/gc/anaconda3/envs/lm/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt
Exception ignored in: <module 'threading' from '/data/gc/anaconda3/envs/lm/lib/python3.10/threading.py'>
Traceback (most recent call last):
  File "/data/gc/anaconda3/envs/lm/lib/python3.10/threading.py", line 1567, in _shutdown
    lock.acquire()
KeyboardInterrupt: 
all_preparation               4970.140ms
all_preparation_2             4968.812ms
all_preparation_3                1.296ms
epoch                         7441.740ms
epoch_pos_train                  1.406ms
epoch_preparation                0.414ms
epoch_train                   7415.494ms
epoch_valid                     23.983ms
----------------------------------------
all                              0.000ms
all_preparation               4970.140ms
  all_preparation_2     99.97%
  all_preparation_3      0.03%
epoch                        22325.219ms
  epoch_train           99.65%
  epoch_valid            0.32%
  epoch_pos_train        0.02%
  epoch_preparation      0.01%
