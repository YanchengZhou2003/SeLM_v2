Before CTE Training: train eu loss: 1.057024359703064, eval eu loss: 1.4517745971679688
Before CTE Training: train eu acc: 0.66552734375, eval eu acc: 0.5794677734375
epoch   0 summary: train_cos_loss : 0.142471, vocab_cro_loss : 4.498505, 
train loss: 4.0915, accuracy: 0.0679
epoch   1 summary: train_cos_loss : 0.126588, vocab_cro_loss : 4.089467, 
epoch   2 summary: train_cos_loss : 0.094751, vocab_cro_loss : 3.164151, 
epoch   3 summary: train_cos_loss : 0.072040, vocab_cro_loss : 2.628922, 
epoch   4 summary: train_cos_loss : 0.055732, vocab_cro_loss : 2.388177, 
epoch   5 summary: train_cos_loss : 0.044891, vocab_cro_loss : 2.260799, 
epoch   6 summary: train_cos_loss : 0.038154, vocab_cro_loss : 2.179079, 
epoch   7 summary: train_cos_loss : 0.033900, vocab_cro_loss : 2.275985, 
epoch   8 summary: train_cos_loss : 0.030791, vocab_cro_loss : 2.559894, 
epoch   9 summary: train_cos_loss : 0.029452, vocab_cro_loss : 2.737316, 
epoch  10 summary: train_cos_loss : 0.027712, vocab_cro_loss : 3.013746, 
train loss: 2.8614, accuracy: 0.4292
epoch  11 summary: train_cos_loss : 0.027334, vocab_cro_loss : 2.856855, 
epoch  12 summary: train_cos_loss : 0.026350, vocab_cro_loss : 3.148645, 
epoch  13 summary: train_cos_loss : 0.026252, vocab_cro_loss : 2.892938, 
epoch  14 summary: train_cos_loss : 0.025331, vocab_cro_loss : 2.736920, 
epoch  15 summary: train_cos_loss : 0.025347, vocab_cro_loss : 2.788162, 
epoch  16 summary: train_cos_loss : 0.024456, vocab_cro_loss : 2.629040, 
epoch  17 summary: train_cos_loss : 0.024025, vocab_cro_loss : 2.610072, 
epoch  18 summary: train_cos_loss : 0.023856, vocab_cro_loss : 2.619340, 
epoch  19 summary: train_cos_loss : 0.023384, vocab_cro_loss : 2.451994, 
epoch  20 summary: train_cos_loss : 0.023121, vocab_cro_loss : 2.361212, 
train loss: 2.3161, accuracy: 0.4802
epoch  21 summary: train_cos_loss : 0.022661, vocab_cro_loss : 2.313708, 
epoch  22 summary: train_cos_loss : 0.022254, vocab_cro_loss : 2.372686, 
epoch  23 summary: train_cos_loss : 0.022112, vocab_cro_loss : 2.400591, 
epoch  24 summary: train_cos_loss : 0.022013, vocab_cro_loss : 2.310651, 
epoch  25 summary: train_cos_loss : 0.021825, vocab_cro_loss : 2.328955, 
epoch  26 summary: train_cos_loss : 0.021632, vocab_cro_loss : 2.252834, 
epoch  27 summary: train_cos_loss : 0.021627, vocab_cro_loss : 2.321038, 
epoch  28 summary: train_cos_loss : 0.021720, vocab_cro_loss : 2.292475, 
epoch  29 summary: train_cos_loss : 0.021688, vocab_cro_loss : 2.301939, 
epoch  30 summary: train_cos_loss : 0.021562, vocab_cro_loss : 2.301780, 
train loss: 2.2936, accuracy: 0.4851
epoch  31 summary: train_cos_loss : 0.021521, vocab_cro_loss : 2.290854, 
epoch  32 summary: train_cos_loss : 0.021557, vocab_cro_loss : 2.362748, 
epoch  33 summary: train_cos_loss : 0.021297, vocab_cro_loss : 2.211413, 
epoch  34 summary: train_cos_loss : 0.021292, vocab_cro_loss : 2.247224, 
epoch  35 summary: train_cos_loss : 0.021194, vocab_cro_loss : 2.142495, 
epoch  36 summary: train_cos_loss : 0.021013, vocab_cro_loss : 2.116987, 
epoch  37 summary: train_cos_loss : 0.021045, vocab_cro_loss : 2.096339, 
epoch  38 summary: train_cos_loss : 0.020977, vocab_cro_loss : 2.266835, 
epoch  39 summary: train_cos_loss : 0.021112, vocab_cro_loss : 2.241602, 
epoch  40 summary: train_cos_loss : 0.020979, vocab_cro_loss : 2.241010, 
train loss: 2.1928, accuracy: 0.4744
epoch  41 summary: train_cos_loss : 0.021052, vocab_cro_loss : 2.191113, 
epoch  42 summary: train_cos_loss : 0.020925, vocab_cro_loss : 2.187009, 
epoch  43 summary: train_cos_loss : 0.020845, vocab_cro_loss : 2.270418, 
epoch  44 summary: train_cos_loss : 0.020838, vocab_cro_loss : 2.302203, 
epoch  45 summary: train_cos_loss : 0.021228, vocab_cro_loss : 2.209723, 
epoch  46 summary: train_cos_loss : 0.020980, vocab_cro_loss : 2.155688, 
epoch  47 summary: train_cos_loss : 0.020833, vocab_cro_loss : 2.140873, 
epoch  48 summary: train_cos_loss : 0.020810, vocab_cro_loss : 2.168254, 
epoch  49 summary: train_cos_loss : 0.021024, vocab_cro_loss : 2.125386, 
epoch  50 summary: train_cos_loss : 0.020962, vocab_cro_loss : 2.200829, 
train loss: 2.2068, accuracy: 0.4297
epoch  51 summary: train_cos_loss : 0.020807, vocab_cro_loss : 2.204773, 
epoch  52 summary: train_cos_loss : 0.020745, vocab_cro_loss : 2.281344, 
epoch  53 summary: train_cos_loss : 0.020780, vocab_cro_loss : 2.250465, 
epoch  54 summary: train_cos_loss : 0.020698, vocab_cro_loss : 2.300432, 
epoch  55 summary: train_cos_loss : 0.020653, vocab_cro_loss : 2.189155, 
epoch  56 summary: train_cos_loss : 0.020608, vocab_cro_loss : 2.184844, 
epoch  57 summary: train_cos_loss : 0.020481, vocab_cro_loss : 2.193903, 
epoch  58 summary: train_cos_loss : 0.020560, vocab_cro_loss : 2.131485, 
epoch  59 summary: train_cos_loss : 0.020472, vocab_cro_loss : 2.128417, 
epoch  60 summary: train_cos_loss : 0.020512, vocab_cro_loss : 2.107688, 
train loss: 2.0984, accuracy: 0.4844
epoch  61 summary: train_cos_loss : 0.020353, vocab_cro_loss : 2.097142, 
epoch  62 summary: train_cos_loss : 0.020453, vocab_cro_loss : 2.180105, 
epoch  63 summary: train_cos_loss : 0.020485, vocab_cro_loss : 2.079227, 
epoch  64 summary: train_cos_loss : 0.020479, vocab_cro_loss : 2.196269, 
epoch  65 summary: train_cos_loss : 0.020576, vocab_cro_loss : 2.130152, 
epoch  66 summary: train_cos_loss : 0.020277, vocab_cro_loss : 2.135904, 
epoch  67 summary: train_cos_loss : 0.020382, vocab_cro_loss : 2.093516, 
epoch  68 summary: train_cos_loss : 0.020439, vocab_cro_loss : 2.213281, 
epoch  69 summary: train_cos_loss : 0.020462, vocab_cro_loss : 2.248458, 
epoch  70 summary: train_cos_loss : 0.020555, vocab_cro_loss : 2.109397, 
train loss: 2.1118, accuracy: 0.4795
epoch  71 summary: train_cos_loss : 0.020486, vocab_cro_loss : 2.109830, 
epoch  72 summary: train_cos_loss : 0.020623, vocab_cro_loss : 2.219612, 
epoch  73 summary: train_cos_loss : 0.020556, vocab_cro_loss : 2.281792, 
epoch  74 summary: train_cos_loss : 0.020505, vocab_cro_loss : 2.172588, 
epoch  75 summary: train_cos_loss : 0.020356, vocab_cro_loss : 2.310492, 
epoch  76 summary: train_cos_loss : 0.020445, vocab_cro_loss : 2.188172, 
epoch  77 summary: train_cos_loss : 0.020427, vocab_cro_loss : 2.175206, 
epoch  78 summary: train_cos_loss : 0.020492, vocab_cro_loss : 2.166723, 
epoch  79 summary: train_cos_loss : 0.020445, vocab_cro_loss : 2.137660, 
epoch  80 summary: train_cos_loss : 0.020473, vocab_cro_loss : 2.046635, 
train loss: 2.1940, accuracy: 0.4700
epoch  81 summary: train_cos_loss : 0.020330, vocab_cro_loss : 2.191165, 
epoch  82 summary: train_cos_loss : 0.020386, vocab_cro_loss : 2.204537, 
epoch  83 summary: train_cos_loss : 0.020321, vocab_cro_loss : 2.093400, 
epoch  84 summary: train_cos_loss : 0.020487, vocab_cro_loss : 2.218430, 
epoch  85 summary: train_cos_loss : 0.020222, vocab_cro_loss : 2.233599, 
epoch  86 summary: train_cos_loss : 0.020209, vocab_cro_loss : 2.158236, 
epoch  87 summary: train_cos_loss : 0.020333, vocab_cro_loss : 2.238217, 
epoch  88 summary: train_cos_loss : 0.020369, vocab_cro_loss : 2.362141, 
epoch  89 summary: train_cos_loss : 0.020248, vocab_cro_loss : 2.229712, 
epoch  90 summary: train_cos_loss : 0.020205, vocab_cro_loss : 2.184831, 
train loss: 2.1127, accuracy: 0.4824
epoch  91 summary: train_cos_loss : 0.020007, vocab_cro_loss : 2.110740, 
epoch  92 summary: train_cos_loss : 0.019944, vocab_cro_loss : 2.162002, 
epoch  93 summary: train_cos_loss : 0.020100, vocab_cro_loss : 2.339721, 
epoch  94 summary: train_cos_loss : 0.020107, vocab_cro_loss : 2.225828, 
epoch  95 summary: train_cos_loss : 0.020293, vocab_cro_loss : 2.513782, 
epoch  96 summary: train_cos_loss : 0.020165, vocab_cro_loss : 2.256624, 
epoch  97 summary: train_cos_loss : 0.020231, vocab_cro_loss : 2.476409, 
epoch  98 summary: train_cos_loss : 0.020314, vocab_cro_loss : 2.450543, 
epoch  99 summary: train_cos_loss : 0.020443, vocab_cro_loss : 2.421810, 
train loss: 2.3236, accuracy: 0.4819
all                         401943.643ms
all_epoch                   395997.192ms
all_preparation               5946.376ms
all_preparation_2             5944.460ms
all_preparation_3                1.831ms
epoch                         3638.070ms
epoch_pos_train                  6.671ms
epoch_preparation               26.712ms
epoch_train                   3587.703ms
epoch_valid                     14.472ms
----------------------------------------
all                         401943.643ms
  all_epoch             98.52%
  all_preparation        1.48%
all_preparation               5946.376ms
  all_preparation_2     99.97%
  all_preparation_3      0.03%
epoch                       363807.016ms
  epoch_train           98.62%
  epoch_preparation      0.73%
  epoch_valid            0.40%
  epoch_pos_train        0.18%
epoch   0 summary: valid_cos_loss : 0.259397, 
valid loss: 3.2089, accuracy: 0.2627
epoch   1 summary: valid_cos_loss : 0.140704, 
epoch   2 summary: valid_cos_loss : 0.084390, 
epoch   3 summary: valid_cos_loss : 0.057620, 
epoch   4 summary: valid_cos_loss : 0.047279, 
epoch   5 summary: valid_cos_loss : 0.042106, 
epoch   6 summary: valid_cos_loss : 0.039683, 
epoch   7 summary: valid_cos_loss : 0.038544, 
epoch   8 summary: valid_cos_loss : 0.038182, 
epoch   9 summary: valid_cos_loss : 0.037285, 
epoch  10 summary: valid_cos_loss : 0.037607, 
valid loss: 2.6915, accuracy: 0.4094
epoch  11 summary: valid_cos_loss : 0.037434, 
epoch  12 summary: valid_cos_loss : 0.037355, 
epoch  13 summary: valid_cos_loss : 0.037439, 
epoch  14 summary: valid_cos_loss : 0.037020, 
epoch  15 summary: valid_cos_loss : 0.037175, 
epoch  16 summary: valid_cos_loss : 0.037366, 
epoch  17 summary: valid_cos_loss : 0.036639, 
epoch  18 summary: valid_cos_loss : 0.036615, 
epoch  19 summary: valid_cos_loss : 0.036549, 
epoch  20 summary: valid_cos_loss : 0.036882, 
valid loss: 2.6995, accuracy: 0.4070
epoch  21 summary: valid_cos_loss : 0.036719, 
epoch  22 summary: valid_cos_loss : 0.036581, 
epoch  23 summary: valid_cos_loss : 0.036400, 
epoch  24 summary: valid_cos_loss : 0.036560, 
epoch  25 summary: valid_cos_loss : 0.036529, 
epoch  26 summary: valid_cos_loss : 0.036587, 
epoch  27 summary: valid_cos_loss : 0.036689, 
epoch  28 summary: valid_cos_loss : 0.036280, 
epoch  29 summary: valid_cos_loss : 0.035839, 
epoch  30 summary: valid_cos_loss : 0.036160, 
valid loss: 2.6956, accuracy: 0.4071
epoch  31 summary: valid_cos_loss : 0.036243, 
epoch  32 summary: valid_cos_loss : 0.036421, 
epoch  33 summary: valid_cos_loss : 0.035971, 
epoch  34 summary: valid_cos_loss : 0.035819, 
epoch  35 summary: valid_cos_loss : 0.035781, 
epoch  36 summary: valid_cos_loss : 0.035703, 
epoch  37 summary: valid_cos_loss : 0.035521, 
epoch  38 summary: valid_cos_loss : 0.035480, 
epoch  39 summary: valid_cos_loss : 0.035793, 
epoch  40 summary: valid_cos_loss : 0.035949, 
valid loss: 2.6921, accuracy: 0.4080
epoch  41 summary: valid_cos_loss : 0.035797, 
epoch  42 summary: valid_cos_loss : 0.035889, 
epoch  43 summary: valid_cos_loss : 0.035882, 
epoch  44 summary: valid_cos_loss : 0.035846, 
epoch  45 summary: valid_cos_loss : 0.035759, 
epoch  46 summary: valid_cos_loss : 0.035553, 
epoch  47 summary: valid_cos_loss : 0.035123, 
epoch  48 summary: valid_cos_loss : 0.035372, 
epoch  49 summary: valid_cos_loss : 0.035616, 
epoch  50 summary: valid_cos_loss : 0.035695, 
valid loss: 2.6972, accuracy: 0.4054
epoch  51 summary: valid_cos_loss : 0.035946, 
epoch  52 summary: valid_cos_loss : 0.035535, 
epoch  53 summary: valid_cos_loss : 0.035132, 
epoch  54 summary: valid_cos_loss : 0.035382, 
epoch  55 summary: valid_cos_loss : 0.035301, 
epoch  56 summary: valid_cos_loss : 0.035179, 
epoch  57 summary: valid_cos_loss : 0.034967, 
epoch  58 summary: valid_cos_loss : 0.035251, 
epoch  59 summary: valid_cos_loss : 0.035417, 
epoch  60 summary: valid_cos_loss : 0.035382, 
valid loss: 2.6897, accuracy: 0.4077
epoch  61 summary: valid_cos_loss : 0.035318, 
epoch  62 summary: valid_cos_loss : 0.034965, 
epoch  63 summary: valid_cos_loss : 0.034982, 
epoch  64 summary: valid_cos_loss : 0.035431, 
epoch  65 summary: valid_cos_loss : 0.035060, 
epoch  66 summary: valid_cos_loss : 0.035137, 
epoch  67 summary: valid_cos_loss : 0.035368, 
epoch  68 summary: valid_cos_loss : 0.034753, 
epoch  69 summary: valid_cos_loss : 0.035442, 
epoch  70 summary: valid_cos_loss : 0.035431, 
valid loss: 2.6965, accuracy: 0.4078
epoch  71 summary: valid_cos_loss : 0.035545, 
epoch  72 summary: valid_cos_loss : 0.035118, 
epoch  73 summary: valid_cos_loss : 0.035120, 
epoch  74 summary: valid_cos_loss : 0.034847, 
epoch  75 summary: valid_cos_loss : 0.034945, 
epoch  76 summary: valid_cos_loss : 0.035160, 
epoch  77 summary: valid_cos_loss : 0.034932, 
epoch  78 summary: valid_cos_loss : 0.035203, 
epoch  79 summary: valid_cos_loss : 0.035310, 
epoch  80 summary: valid_cos_loss : 0.035284, 
valid loss: 2.6786, accuracy: 0.4111
epoch  81 summary: valid_cos_loss : 0.035133, 
epoch  82 summary: valid_cos_loss : 0.035228, 
epoch  83 summary: valid_cos_loss : 0.035090, 
epoch  84 summary: valid_cos_loss : 0.035203, 
epoch  85 summary: valid_cos_loss : 0.035370, 
epoch  86 summary: valid_cos_loss : 0.035030, 
epoch  87 summary: valid_cos_loss : 0.035067, 
epoch  88 summary: valid_cos_loss : 0.035171, 
epoch  89 summary: valid_cos_loss : 0.034931, 
epoch  90 summary: valid_cos_loss : 0.035512, 
valid loss: 2.6868, accuracy: 0.4105
epoch  91 summary: valid_cos_loss : 0.035210, 
epoch  92 summary: valid_cos_loss : 0.035124, 
epoch  93 summary: valid_cos_loss : 0.034520, 
epoch  94 summary: valid_cos_loss : 0.034860, 
epoch  95 summary: valid_cos_loss : 0.034778, 
epoch  96 summary: valid_cos_loss : 0.034742, 
epoch  97 summary: valid_cos_loss : 0.034741, 
epoch  98 summary: valid_cos_loss : 0.034985, 
epoch  99 summary: valid_cos_loss : 0.034922, 
valid loss: 2.6884, accuracy: 0.4119
all                         738443.754ms
all_epoch                   738410.544ms
all_preparation                 33.153ms
all_preparation_2               31.490ms
all_preparation_3                1.629ms
epoch                         7151.549ms
epoch_pos_train                  7.035ms
epoch_preparation                1.573ms
epoch_train                   7105.231ms
epoch_valid                     35.945ms
----------------------------------------
all                         738443.754ms
  all_epoch            100.00%
  all_preparation        0.00%
all_preparation                 33.153ms
  all_preparation_2     94.98%
  all_preparation_3      4.91%
epoch                       715154.941ms
  epoch_train           99.35%
  epoch_valid            0.50%
  epoch_pos_train        0.10%
  epoch_preparation      0.02%
