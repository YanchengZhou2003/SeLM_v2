Before CTE Training: train eu loss: 1.063186526298523, eval eu loss: 1.4517745971679688
Before CTE Training: train eu acc: 0.6669921875, eval eu acc: 0.5794677734375
epoch   0 summary: train_cos_loss : 0.149290, vocab_cro_loss : 4.897259, 
train loss: 4.2536, accuracy: 0.0718
epoch   1 summary: train_cos_loss : 0.130667, vocab_cro_loss : 4.249931, 
epoch   2 summary: train_cos_loss : 0.105605, vocab_cro_loss : 3.452424, 
epoch   3 summary: train_cos_loss : 0.084275, vocab_cro_loss : 2.920736, 
epoch   4 summary: train_cos_loss : 0.068347, vocab_cro_loss : 2.632277, 
epoch   5 summary: train_cos_loss : 0.056523, vocab_cro_loss : 2.501017, 
epoch   6 summary: train_cos_loss : 0.048879, vocab_cro_loss : 2.379531, 
epoch   7 summary: train_cos_loss : 0.044219, vocab_cro_loss : 2.275537, 
epoch   8 summary: train_cos_loss : 0.041202, vocab_cro_loss : 2.226750, 
epoch   9 summary: train_cos_loss : 0.038920, vocab_cro_loss : 2.193356, 
epoch  10 summary: train_cos_loss : 0.037477, vocab_cro_loss : 2.155368, 
train loss: 2.1341, accuracy: 0.4341
epoch  11 summary: train_cos_loss : 0.036669, vocab_cro_loss : 2.133857, 
epoch  12 summary: train_cos_loss : 0.035991, vocab_cro_loss : 2.121164, 
epoch  13 summary: train_cos_loss : 0.035653, vocab_cro_loss : 2.110325, 
epoch  14 summary: train_cos_loss : 0.035341, vocab_cro_loss : 2.105727, 
epoch  15 summary: train_cos_loss : 0.035091, vocab_cro_loss : 2.089751, 
epoch  16 summary: train_cos_loss : 0.034863, vocab_cro_loss : 2.092696, 
epoch  17 summary: train_cos_loss : 0.034708, vocab_cro_loss : 2.082508, 
epoch  18 summary: train_cos_loss : 0.034534, vocab_cro_loss : 2.078464, 
epoch  19 summary: train_cos_loss : 0.034400, vocab_cro_loss : 2.078687, 
epoch  20 summary: train_cos_loss : 0.034266, vocab_cro_loss : 2.074478, 
train loss: 2.0658, accuracy: 0.4609
epoch  21 summary: train_cos_loss : 0.034056, vocab_cro_loss : 2.065721, 
epoch  22 summary: train_cos_loss : 0.033913, vocab_cro_loss : 2.058678, 
epoch  23 summary: train_cos_loss : 0.033795, vocab_cro_loss : 2.049475, 
epoch  24 summary: train_cos_loss : 0.033740, vocab_cro_loss : 2.044745, 
epoch  25 summary: train_cos_loss : 0.033626, vocab_cro_loss : 2.042343, 
epoch  26 summary: train_cos_loss : 0.033619, vocab_cro_loss : 2.041490, 
epoch  27 summary: train_cos_loss : 0.033466, vocab_cro_loss : 2.038216, 
epoch  28 summary: train_cos_loss : 0.033393, vocab_cro_loss : 2.033520, 
epoch  29 summary: train_cos_loss : 0.033271, vocab_cro_loss : 2.030513, 
epoch  30 summary: train_cos_loss : 0.033114, vocab_cro_loss : 2.033701, 
train loss: 2.0338, accuracy: 0.4531
epoch  31 summary: train_cos_loss : 0.032989, vocab_cro_loss : 2.033766, 
epoch  32 summary: train_cos_loss : 0.032852, vocab_cro_loss : 2.027319, 
epoch  33 summary: train_cos_loss : 0.032825, vocab_cro_loss : 2.024363, 
epoch  34 summary: train_cos_loss : 0.032730, vocab_cro_loss : 2.023564, 
epoch  35 summary: train_cos_loss : 0.032716, vocab_cro_loss : 2.019420, 
epoch  36 summary: train_cos_loss : 0.032816, vocab_cro_loss : 2.018841, 
epoch  37 summary: train_cos_loss : 0.032735, vocab_cro_loss : 2.014594, 
epoch  38 summary: train_cos_loss : 0.032735, vocab_cro_loss : 2.015201, 
epoch  39 summary: train_cos_loss : 0.032684, vocab_cro_loss : 2.013659, 
epoch  40 summary: train_cos_loss : 0.032602, vocab_cro_loss : 2.012415, 
train loss: 2.0098, accuracy: 0.4648
epoch  41 summary: train_cos_loss : 0.032577, vocab_cro_loss : 2.009762, 
epoch  42 summary: train_cos_loss : 0.032446, vocab_cro_loss : 2.004299, 
epoch  43 summary: train_cos_loss : 0.032209, vocab_cro_loss : 2.004786, 
epoch  44 summary: train_cos_loss : 0.032028, vocab_cro_loss : 2.000192, 
epoch  45 summary: train_cos_loss : 0.031998, vocab_cro_loss : 2.001563, 
epoch  46 summary: train_cos_loss : 0.032027, vocab_cro_loss : 2.001824, 
epoch  47 summary: train_cos_loss : 0.031981, vocab_cro_loss : 2.000692, 
epoch  48 summary: train_cos_loss : 0.031988, vocab_cro_loss : 2.004510, 
epoch  49 summary: train_cos_loss : 0.031976, vocab_cro_loss : 2.003896, 
epoch  50 summary: train_cos_loss : 0.032095, vocab_cro_loss : 2.005294, 
train loss: 1.9987, accuracy: 0.4634
epoch  51 summary: train_cos_loss : 0.032014, vocab_cro_loss : 1.998662, 
epoch  52 summary: train_cos_loss : 0.032022, vocab_cro_loss : 1.996174, 
epoch  53 summary: train_cos_loss : 0.032011, vocab_cro_loss : 1.992799, 
epoch  54 summary: train_cos_loss : 0.031987, vocab_cro_loss : 1.992889, 
epoch  55 summary: train_cos_loss : 0.031956, vocab_cro_loss : 1.991468, 
epoch  56 summary: train_cos_loss : 0.031948, vocab_cro_loss : 1.992919, 
epoch  57 summary: train_cos_loss : 0.031945, vocab_cro_loss : 1.991962, 
epoch  58 summary: train_cos_loss : 0.031949, vocab_cro_loss : 1.992702, 
epoch  59 summary: train_cos_loss : 0.031914, vocab_cro_loss : 1.988149, 
epoch  60 summary: train_cos_loss : 0.031958, vocab_cro_loss : 1.990638, 
train loss: 1.9854, accuracy: 0.4692
epoch  61 summary: train_cos_loss : 0.031890, vocab_cro_loss : 1.985389, 
epoch  62 summary: train_cos_loss : 0.031895, vocab_cro_loss : 1.986410, 
epoch  63 summary: train_cos_loss : 0.031876, vocab_cro_loss : 1.986794, 
epoch  64 summary: train_cos_loss : 0.031878, vocab_cro_loss : 1.988700, 
epoch  65 summary: train_cos_loss : 0.031878, vocab_cro_loss : 1.988560, 
epoch  66 summary: train_cos_loss : 0.031846, vocab_cro_loss : 1.988108, 
epoch  67 summary: train_cos_loss : 0.031814, vocab_cro_loss : 1.985918, 
epoch  68 summary: train_cos_loss : 0.031798, vocab_cro_loss : 1.986247, 
epoch  69 summary: train_cos_loss : 0.031797, vocab_cro_loss : 1.984734, 
epoch  70 summary: train_cos_loss : 0.031755, vocab_cro_loss : 1.987055, 
train loss: 1.9872, accuracy: 0.4697
epoch  71 summary: train_cos_loss : 0.031679, vocab_cro_loss : 1.987129, 
epoch  72 summary: train_cos_loss : 0.031729, vocab_cro_loss : 1.985693, 
epoch  73 summary: train_cos_loss : 0.031722, vocab_cro_loss : 1.985524, 
epoch  74 summary: train_cos_loss : 0.031768, vocab_cro_loss : 1.984307, 
epoch  75 summary: train_cos_loss : 0.031689, vocab_cro_loss : 1.983659, 
epoch  76 summary: train_cos_loss : 0.031688, vocab_cro_loss : 1.986673, 
epoch  77 summary: train_cos_loss : 0.031672, vocab_cro_loss : 1.987061, 
epoch  78 summary: train_cos_loss : 0.031686, vocab_cro_loss : 1.989472, 
epoch  79 summary: train_cos_loss : 0.031653, vocab_cro_loss : 1.986752, 
epoch  80 summary: train_cos_loss : 0.031704, vocab_cro_loss : 1.987695, 
train loss: 1.9891, accuracy: 0.4688
epoch  81 summary: train_cos_loss : 0.031614, vocab_cro_loss : 1.989086, 
epoch  82 summary: train_cos_loss : 0.031556, vocab_cro_loss : 1.991948, 
epoch  83 summary: train_cos_loss : 0.031476, vocab_cro_loss : 1.993010, 
epoch  84 summary: train_cos_loss : 0.031492, vocab_cro_loss : 1.993967, 
epoch  85 summary: train_cos_loss : 0.031469, vocab_cro_loss : 1.993690, 
epoch  86 summary: train_cos_loss : 0.031476, vocab_cro_loss : 1.995158, 
epoch  87 summary: train_cos_loss : 0.031441, vocab_cro_loss : 1.991452, 
epoch  88 summary: train_cos_loss : 0.031407, vocab_cro_loss : 1.993284, 
epoch  89 summary: train_cos_loss : 0.031396, vocab_cro_loss : 1.994195, 
epoch  90 summary: train_cos_loss : 0.031273, vocab_cro_loss : 1.989762, 
train loss: 1.9865, accuracy: 0.4668
epoch  91 summary: train_cos_loss : 0.031066, vocab_cro_loss : 1.986499, 
epoch  92 summary: train_cos_loss : 0.031037, vocab_cro_loss : 1.986268, 
epoch  93 summary: train_cos_loss : 0.030945, vocab_cro_loss : 1.987465, 
epoch  94 summary: train_cos_loss : 0.030919, vocab_cro_loss : 1.983116, 
epoch  95 summary: train_cos_loss : 0.030901, vocab_cro_loss : 1.983930, 
epoch  96 summary: train_cos_loss : 0.030885, vocab_cro_loss : 1.984273, 
epoch  97 summary: train_cos_loss : 0.030868, vocab_cro_loss : 1.987604, 
epoch  98 summary: train_cos_loss : 0.030876, vocab_cro_loss : 1.986492, 
epoch  99 summary: train_cos_loss : 0.030871, vocab_cro_loss : 1.986846, 
train loss: 1.9877, accuracy: 0.4668
all                         151012.891ms
all_epoch                   145586.917ms
all_preparation               5425.944ms
all_preparation_2             5423.356ms
all_preparation_3                2.538ms
epoch                         1173.627ms
epoch_pos_train                  6.128ms
epoch_preparation               17.677ms
epoch_train                   1139.004ms
epoch_valid                      8.479ms
----------------------------------------
all                         151012.891ms
  all_epoch             96.41%
  all_preparation        3.59%
all_preparation               5425.944ms
  all_preparation_2     99.95%
  all_preparation_3      0.05%
epoch                       117362.671ms
  epoch_train           97.05%
  epoch_preparation      1.51%
  epoch_valid            0.72%
  epoch_pos_train        0.52%
epoch   0 summary: valid_cos_loss : 0.237156, 
valid loss: 3.1059, accuracy: 0.2450
epoch   1 summary: valid_cos_loss : 0.133608, 
epoch   2 summary: valid_cos_loss : 0.084444, 
epoch   3 summary: valid_cos_loss : 0.061723, 
epoch   4 summary: valid_cos_loss : 0.051161, 
epoch   5 summary: valid_cos_loss : 0.046324, 
epoch   6 summary: valid_cos_loss : 0.043891, 
epoch   7 summary: valid_cos_loss : 0.042613, 
epoch   8 summary: valid_cos_loss : 0.041965, 
epoch   9 summary: valid_cos_loss : 0.041473, 
epoch  10 summary: valid_cos_loss : 0.041712, 
valid loss: 2.3544, accuracy: 0.4154
epoch  11 summary: valid_cos_loss : 0.041296, 
epoch  12 summary: valid_cos_loss : 0.041053, 
epoch  13 summary: valid_cos_loss : 0.040814, 
epoch  14 summary: valid_cos_loss : 0.040718, 
epoch  15 summary: valid_cos_loss : 0.040548, 
epoch  16 summary: valid_cos_loss : 0.040442, 
epoch  17 summary: valid_cos_loss : 0.040415, 
epoch  18 summary: valid_cos_loss : 0.040348, 
epoch  19 summary: valid_cos_loss : 0.040301, 
epoch  20 summary: valid_cos_loss : 0.040715, 
valid loss: 2.3603, accuracy: 0.4152
epoch  21 summary: valid_cos_loss : 0.040446, 
epoch  22 summary: valid_cos_loss : 0.040296, 
epoch  23 summary: valid_cos_loss : 0.040190, 
epoch  24 summary: valid_cos_loss : 0.040106, 
epoch  25 summary: valid_cos_loss : 0.040076, 
epoch  26 summary: valid_cos_loss : 0.040017, 
epoch  27 summary: valid_cos_loss : 0.039976, 
epoch  28 summary: valid_cos_loss : 0.039948, 
epoch  29 summary: valid_cos_loss : 0.039914, 
epoch  30 summary: valid_cos_loss : 0.040317, 
valid loss: 2.3586, accuracy: 0.4163
epoch  31 summary: valid_cos_loss : 0.040137, 
epoch  32 summary: valid_cos_loss : 0.040033, 
epoch  33 summary: valid_cos_loss : 0.040004, 
epoch  34 summary: valid_cos_loss : 0.039973, 
epoch  35 summary: valid_cos_loss : 0.039916, 
epoch  36 summary: valid_cos_loss : 0.039848, 
epoch  37 summary: valid_cos_loss : 0.039829, 
epoch  38 summary: valid_cos_loss : 0.039879, 
epoch  39 summary: valid_cos_loss : 0.039801, 
epoch  40 summary: valid_cos_loss : 0.040221, 
valid loss: 2.3563, accuracy: 0.4166
epoch  41 summary: valid_cos_loss : 0.040016, 
epoch  42 summary: valid_cos_loss : 0.039942, 
epoch  43 summary: valid_cos_loss : 0.039836, 
epoch  44 summary: valid_cos_loss : 0.039780, 
epoch  45 summary: valid_cos_loss : 0.039793, 
epoch  46 summary: valid_cos_loss : 0.039735, 
epoch  47 summary: valid_cos_loss : 0.039732, 
epoch  48 summary: valid_cos_loss : 0.039692, 
epoch  49 summary: valid_cos_loss : 0.039679, 
epoch  50 summary: valid_cos_loss : 0.040100, 
valid loss: 2.3569, accuracy: 0.4156
epoch  51 summary: valid_cos_loss : 0.039847, 
epoch  52 summary: valid_cos_loss : 0.039750, 
epoch  53 summary: valid_cos_loss : 0.039719, 
epoch  54 summary: valid_cos_loss : 0.039672, 
epoch  55 summary: valid_cos_loss : 0.039643, 
epoch  56 summary: valid_cos_loss : 0.039631, 
epoch  57 summary: valid_cos_loss : 0.039593, 
epoch  58 summary: valid_cos_loss : 0.039626, 
epoch  59 summary: valid_cos_loss : 0.039579, 
epoch  60 summary: valid_cos_loss : 0.039919, 
valid loss: 2.3568, accuracy: 0.4159
epoch  61 summary: valid_cos_loss : 0.039720, 
epoch  62 summary: valid_cos_loss : 0.039653, 
epoch  63 summary: valid_cos_loss : 0.039578, 
epoch  64 summary: valid_cos_loss : 0.039556, 
epoch  65 summary: valid_cos_loss : 0.039565, 
epoch  66 summary: valid_cos_loss : 0.039537, 
epoch  67 summary: valid_cos_loss : 0.039490, 
epoch  68 summary: valid_cos_loss : 0.039506, 
epoch  69 summary: valid_cos_loss : 0.039493, 
epoch  70 summary: valid_cos_loss : 0.039920, 
valid loss: 2.3546, accuracy: 0.4180
epoch  71 summary: valid_cos_loss : 0.039703, 
epoch  72 summary: valid_cos_loss : 0.039587, 
epoch  73 summary: valid_cos_loss : 0.039564, 
epoch  74 summary: valid_cos_loss : 0.039530, 
epoch  75 summary: valid_cos_loss : 0.039470, 
epoch  76 summary: valid_cos_loss : 0.039484, 
epoch  77 summary: valid_cos_loss : 0.039456, 
epoch  78 summary: valid_cos_loss : 0.039424, 
epoch  79 summary: valid_cos_loss : 0.039442, 
epoch  80 summary: valid_cos_loss : 0.039804, 
valid loss: 2.3584, accuracy: 0.4163
epoch  81 summary: valid_cos_loss : 0.039585, 
epoch  82 summary: valid_cos_loss : 0.039528, 
epoch  83 summary: valid_cos_loss : 0.039479, 
epoch  84 summary: valid_cos_loss : 0.039420, 
epoch  85 summary: valid_cos_loss : 0.039422, 
epoch  86 summary: valid_cos_loss : 0.039410, 
epoch  87 summary: valid_cos_loss : 0.039431, 
epoch  88 summary: valid_cos_loss : 0.039391, 
epoch  89 summary: valid_cos_loss : 0.039375, 
epoch  90 summary: valid_cos_loss : 0.039773, 
valid loss: 2.3561, accuracy: 0.4172
epoch  91 summary: valid_cos_loss : 0.039561, 
epoch  92 summary: valid_cos_loss : 0.039480, 
epoch  93 summary: valid_cos_loss : 0.039463, 
epoch  94 summary: valid_cos_loss : 0.039414, 
epoch  95 summary: valid_cos_loss : 0.039398, 
epoch  96 summary: valid_cos_loss : 0.039377, 
epoch  97 summary: valid_cos_loss : 0.039377, 
epoch  98 summary: valid_cos_loss : 0.039375, 
epoch  99 summary: valid_cos_loss : 0.039343, 
valid loss: 2.3574, accuracy: 0.4158
all                         501067.564ms
all_epoch                   501043.893ms
all_preparation                 23.622ms
all_preparation_2               22.372ms
all_preparation_3                1.229ms
epoch                         4823.467ms
epoch_pos_train                  8.302ms
epoch_preparation                1.261ms
epoch_train                   4779.111ms
epoch_valid                     32.732ms
----------------------------------------
all                         501067.564ms
  all_epoch            100.00%
  all_preparation        0.00%
all_preparation                 23.622ms
  all_preparation_2     94.71%
  all_preparation_3      5.20%
epoch                       482346.658ms
  epoch_train           99.08%
  epoch_valid            0.68%
  epoch_pos_train        0.17%
  epoch_preparation      0.03%
