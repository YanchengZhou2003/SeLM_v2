Before CTE Training: train eu loss: 1.057024359703064, eval eu loss: 1.4517745971679688
Before CTE Training: train eu acc: 0.66552734375, eval eu acc: 0.5794677734375
epoch   0 summary: train_cos_loss : 0.162451, vocab_cro_loss : 5.949142, 
train loss: 5.0952, accuracy: 0.0447
epoch   1 summary: train_cos_loss : 0.136123, vocab_cro_loss : 5.087677, 
epoch   2 summary: train_cos_loss : 0.100213, vocab_cro_loss : 3.904723, 
epoch   3 summary: train_cos_loss : 0.077937, vocab_cro_loss : 3.239694, 
epoch   4 summary: train_cos_loss : 0.063478, vocab_cro_loss : 2.876062, 
epoch   5 summary: train_cos_loss : 0.054334, vocab_cro_loss : 2.762575, 
epoch   6 summary: train_cos_loss : 0.048747, vocab_cro_loss : 2.697958, 
epoch   7 summary: train_cos_loss : 0.045855, vocab_cro_loss : 2.645602, 
epoch   8 summary: train_cos_loss : 0.043731, vocab_cro_loss : 2.617334, 
epoch   9 summary: train_cos_loss : 0.042595, vocab_cro_loss : 2.614916, 
epoch  10 summary: train_cos_loss : 0.041932, vocab_cro_loss : 2.590046, 
train loss: 2.5772, accuracy: 0.3699
epoch  11 summary: train_cos_loss : 0.040796, vocab_cro_loss : 2.576793, 
epoch  12 summary: train_cos_loss : 0.040048, vocab_cro_loss : 2.563208, 
epoch  13 summary: train_cos_loss : 0.039242, vocab_cro_loss : 2.558540, 
epoch  14 summary: train_cos_loss : 0.038560, vocab_cro_loss : 2.564906, 
epoch  15 summary: train_cos_loss : 0.038138, vocab_cro_loss : 2.569620, 
epoch  16 summary: train_cos_loss : 0.037672, vocab_cro_loss : 2.566390, 
epoch  17 summary: train_cos_loss : 0.037283, vocab_cro_loss : 2.574523, 
epoch  18 summary: train_cos_loss : 0.036837, vocab_cro_loss : 2.554205, 
epoch  19 summary: train_cos_loss : 0.036572, vocab_cro_loss : 2.533898, 
epoch  20 summary: train_cos_loss : 0.036345, vocab_cro_loss : 2.516618, 
train loss: 2.5022, accuracy: 0.3894
epoch  21 summary: train_cos_loss : 0.036089, vocab_cro_loss : 2.502046, 
epoch  22 summary: train_cos_loss : 0.035894, vocab_cro_loss : 2.493238, 
epoch  23 summary: train_cos_loss : 0.035682, vocab_cro_loss : 2.479608, 
epoch  24 summary: train_cos_loss : 0.035584, vocab_cro_loss : 2.473998, 
epoch  25 summary: train_cos_loss : 0.035440, vocab_cro_loss : 2.465738, 
epoch  26 summary: train_cos_loss : 0.035416, vocab_cro_loss : 2.467343, 
epoch  27 summary: train_cos_loss : 0.035329, vocab_cro_loss : 2.464922, 
epoch  28 summary: train_cos_loss : 0.035262, vocab_cro_loss : 2.461097, 
epoch  29 summary: train_cos_loss : 0.035169, vocab_cro_loss : 2.461328, 
epoch  30 summary: train_cos_loss : 0.035223, vocab_cro_loss : 2.459140, 
train loss: 2.4604, accuracy: 0.3943
epoch  31 summary: train_cos_loss : 0.035101, vocab_cro_loss : 2.460319, 
epoch  32 summary: train_cos_loss : 0.034976, vocab_cro_loss : 2.457988, 
epoch  33 summary: train_cos_loss : 0.034948, vocab_cro_loss : 2.455481, 
epoch  34 summary: train_cos_loss : 0.034763, vocab_cro_loss : 2.446922, 
epoch  35 summary: train_cos_loss : 0.034609, vocab_cro_loss : 2.440158, 
epoch  36 summary: train_cos_loss : 0.034482, vocab_cro_loss : 2.437869, 
epoch  37 summary: train_cos_loss : 0.034396, vocab_cro_loss : 2.439332, 
epoch  38 summary: train_cos_loss : 0.034355, vocab_cro_loss : 2.442025, 
epoch  39 summary: train_cos_loss : 0.034224, vocab_cro_loss : 2.437168, 
epoch  40 summary: train_cos_loss : 0.034223, vocab_cro_loss : 2.431182, 
train loss: 2.4230, accuracy: 0.3955
epoch  41 summary: train_cos_loss : 0.034087, vocab_cro_loss : 2.422882, 
epoch  42 summary: train_cos_loss : 0.033937, vocab_cro_loss : 2.427871, 
epoch  43 summary: train_cos_loss : 0.033860, vocab_cro_loss : 2.428757, 
epoch  44 summary: train_cos_loss : 0.033806, vocab_cro_loss : 2.424086, 
epoch  45 summary: train_cos_loss : 0.033791, vocab_cro_loss : 2.415402, 
epoch  46 summary: train_cos_loss : 0.033694, vocab_cro_loss : 2.413192, 
epoch  47 summary: train_cos_loss : 0.033687, vocab_cro_loss : 2.425541, 
epoch  48 summary: train_cos_loss : 0.033681, vocab_cro_loss : 2.410426, 
epoch  49 summary: train_cos_loss : 0.033657, vocab_cro_loss : 2.429219, 
epoch  50 summary: train_cos_loss : 0.033739, vocab_cro_loss : 2.430369, 
train loss: 2.4152, accuracy: 0.3909
epoch  51 summary: train_cos_loss : 0.033724, vocab_cro_loss : 2.415067, 
epoch  52 summary: train_cos_loss : 0.033686, vocab_cro_loss : 2.403407, 
epoch  53 summary: train_cos_loss : 0.033600, vocab_cro_loss : 2.428811, 
epoch  54 summary: train_cos_loss : 0.033588, vocab_cro_loss : 2.420116, 
epoch  55 summary: train_cos_loss : 0.033572, vocab_cro_loss : 2.419619, 
epoch  56 summary: train_cos_loss : 0.033532, vocab_cro_loss : 2.445695, 
epoch  57 summary: train_cos_loss : 0.033493, vocab_cro_loss : 2.428473, 
epoch  58 summary: train_cos_loss : 0.033462, vocab_cro_loss : 2.420887, 
epoch  59 summary: train_cos_loss : 0.033425, vocab_cro_loss : 2.417694, 
epoch  60 summary: train_cos_loss : 0.033431, vocab_cro_loss : 2.397996, 
train loss: 2.3924, accuracy: 0.4004
epoch  61 summary: train_cos_loss : 0.033338, vocab_cro_loss : 2.392284, 
epoch  62 summary: train_cos_loss : 0.033237, vocab_cro_loss : 2.385354, 
epoch  63 summary: train_cos_loss : 0.033182, vocab_cro_loss : 2.385827, 
epoch  64 summary: train_cos_loss : 0.033159, vocab_cro_loss : 2.383417, 
epoch  65 summary: train_cos_loss : 0.033132, vocab_cro_loss : 2.382020, 
epoch  66 summary: train_cos_loss : 0.033099, vocab_cro_loss : 2.381067, 
epoch  67 summary: train_cos_loss : 0.033074, vocab_cro_loss : 2.380560, 
epoch  68 summary: train_cos_loss : 0.033061, vocab_cro_loss : 2.381782, 
epoch  69 summary: train_cos_loss : 0.033081, vocab_cro_loss : 2.380042, 
epoch  70 summary: train_cos_loss : 0.033171, vocab_cro_loss : 2.379030, 
train loss: 2.3807, accuracy: 0.4031
epoch  71 summary: train_cos_loss : 0.033077, vocab_cro_loss : 2.380654, 
epoch  72 summary: train_cos_loss : 0.033107, vocab_cro_loss : 2.381716, 
epoch  73 summary: train_cos_loss : 0.033049, vocab_cro_loss : 2.381557, 
epoch  74 summary: train_cos_loss : 0.033062, vocab_cro_loss : 2.381113, 
epoch  75 summary: train_cos_loss : 0.032984, vocab_cro_loss : 2.381009, 
epoch  76 summary: train_cos_loss : 0.032993, vocab_cro_loss : 2.386073, 
epoch  77 summary: train_cos_loss : 0.032941, vocab_cro_loss : 2.381438, 
epoch  78 summary: train_cos_loss : 0.032966, vocab_cro_loss : 2.383938, 
epoch  79 summary: train_cos_loss : 0.032901, vocab_cro_loss : 2.380901, 
epoch  80 summary: train_cos_loss : 0.032963, vocab_cro_loss : 2.378392, 
train loss: 2.3790, accuracy: 0.4050
epoch  81 summary: train_cos_loss : 0.032911, vocab_cro_loss : 2.378875, 
epoch  82 summary: train_cos_loss : 0.032858, vocab_cro_loss : 2.384956, 
epoch  83 summary: train_cos_loss : 0.032786, vocab_cro_loss : 2.379303, 
epoch  84 summary: train_cos_loss : 0.032752, vocab_cro_loss : 2.379727, 
epoch  85 summary: train_cos_loss : 0.032738, vocab_cro_loss : 2.373857, 
epoch  86 summary: train_cos_loss : 0.032667, vocab_cro_loss : 2.375019, 
epoch  87 summary: train_cos_loss : 0.032599, vocab_cro_loss : 2.368917, 
epoch  88 summary: train_cos_loss : 0.032543, vocab_cro_loss : 2.368450, 
epoch  89 summary: train_cos_loss : 0.032456, vocab_cro_loss : 2.365798, 
epoch  90 summary: train_cos_loss : 0.032495, vocab_cro_loss : 2.365361, 
train loss: 2.3618, accuracy: 0.4109
epoch  91 summary: train_cos_loss : 0.032390, vocab_cro_loss : 2.361738, 
epoch  92 summary: train_cos_loss : 0.032319, vocab_cro_loss : 2.354888, 
epoch  93 summary: train_cos_loss : 0.032123, vocab_cro_loss : 2.341722, 
epoch  94 summary: train_cos_loss : 0.032008, vocab_cro_loss : 2.343945, 
epoch  95 summary: train_cos_loss : 0.031787, vocab_cro_loss : 2.333055, 
epoch  96 summary: train_cos_loss : 0.031554, vocab_cro_loss : 2.332727, 
epoch  97 summary: train_cos_loss : 0.031466, vocab_cro_loss : 2.332249, 
epoch  98 summary: train_cos_loss : 0.031359, vocab_cro_loss : 2.335021, 
epoch  99 summary: train_cos_loss : 0.031218, vocab_cro_loss : 2.326763, 
train loss: 2.3309, accuracy: 0.4121
all                         330426.239ms
all_epoch                   324479.676ms
all_preparation               5946.528ms
all_preparation_2             5944.516ms
all_preparation_3                1.974ms
epoch                         2925.521ms
epoch_pos_train                  7.311ms
epoch_preparation               17.805ms
epoch_train                   2878.952ms
epoch_valid                     18.805ms
----------------------------------------
all                         330426.239ms
  all_epoch             98.20%
  all_preparation        1.80%
all_preparation               5946.528ms
  all_preparation_2     99.97%
  all_preparation_3      0.03%
epoch                       292552.083ms
  epoch_train           98.41%
  epoch_valid            0.64%
  epoch_preparation      0.61%
  epoch_pos_train        0.25%
epoch   0 summary: valid_cos_loss : 0.270079, 
valid loss: 3.4289, accuracy: 0.2631
epoch   1 summary: valid_cos_loss : 0.139097, 
epoch   2 summary: valid_cos_loss : 0.085543, 
epoch   3 summary: valid_cos_loss : 0.063903, 
epoch   4 summary: valid_cos_loss : 0.055100, 
epoch   5 summary: valid_cos_loss : 0.051092, 
epoch   6 summary: valid_cos_loss : 0.049083, 
epoch   7 summary: valid_cos_loss : 0.048016, 
epoch   8 summary: valid_cos_loss : 0.047271, 
epoch   9 summary: valid_cos_loss : 0.046745, 
epoch  10 summary: valid_cos_loss : 0.047913, 
valid loss: 2.7350, accuracy: 0.3534
epoch  11 summary: valid_cos_loss : 0.046897, 
epoch  12 summary: valid_cos_loss : 0.046338, 
epoch  13 summary: valid_cos_loss : 0.046088, 
epoch  14 summary: valid_cos_loss : 0.045906, 
epoch  15 summary: valid_cos_loss : 0.045689, 
epoch  16 summary: valid_cos_loss : 0.045569, 
epoch  17 summary: valid_cos_loss : 0.045592, 
epoch  18 summary: valid_cos_loss : 0.045400, 
epoch  19 summary: valid_cos_loss : 0.045380, 
epoch  20 summary: valid_cos_loss : 0.046499, 
valid loss: 2.7470, accuracy: 0.3534
epoch  21 summary: valid_cos_loss : 0.045837, 
epoch  22 summary: valid_cos_loss : 0.045476, 
epoch  23 summary: valid_cos_loss : 0.045346, 
epoch  24 summary: valid_cos_loss : 0.045160, 
epoch  25 summary: valid_cos_loss : 0.045121, 
epoch  26 summary: valid_cos_loss : 0.045126, 
epoch  27 summary: valid_cos_loss : 0.045052, 
epoch  28 summary: valid_cos_loss : 0.044938, 
epoch  29 summary: valid_cos_loss : 0.044987, 
epoch  30 summary: valid_cos_loss : 0.046145, 
valid loss: 2.7537, accuracy: 0.3518
epoch  31 summary: valid_cos_loss : 0.045534, 
epoch  32 summary: valid_cos_loss : 0.045212, 
epoch  33 summary: valid_cos_loss : 0.045081, 
epoch  34 summary: valid_cos_loss : 0.045029, 
epoch  35 summary: valid_cos_loss : 0.044908, 
epoch  36 summary: valid_cos_loss : 0.044876, 
epoch  37 summary: valid_cos_loss : 0.044868, 
epoch  38 summary: valid_cos_loss : 0.044880, 
epoch  39 summary: valid_cos_loss : 0.044799, 
epoch  40 summary: valid_cos_loss : 0.046073, 
valid loss: 2.7651, accuracy: 0.3522
epoch  41 summary: valid_cos_loss : 0.045388, 
epoch  42 summary: valid_cos_loss : 0.045107, 
epoch  43 summary: valid_cos_loss : 0.044985, 
epoch  44 summary: valid_cos_loss : 0.044889, 
epoch  45 summary: valid_cos_loss : 0.044816, 
epoch  46 summary: valid_cos_loss : 0.044861, 
epoch  47 summary: valid_cos_loss : 0.044752, 
epoch  48 summary: valid_cos_loss : 0.044750, 
epoch  49 summary: valid_cos_loss : 0.044691, 
epoch  50 summary: valid_cos_loss : 0.045771, 
valid loss: 2.7614, accuracy: 0.3555
epoch  51 summary: valid_cos_loss : 0.045182, 
epoch  52 summary: valid_cos_loss : 0.044909, 
epoch  53 summary: valid_cos_loss : 0.044771, 
epoch  54 summary: valid_cos_loss : 0.044705, 
epoch  55 summary: valid_cos_loss : 0.044676, 
epoch  56 summary: valid_cos_loss : 0.044637, 
epoch  57 summary: valid_cos_loss : 0.044611, 
epoch  58 summary: valid_cos_loss : 0.044587, 
epoch  59 summary: valid_cos_loss : 0.044515, 
epoch  60 summary: valid_cos_loss : 0.045690, 
valid loss: 2.7615, accuracy: 0.3545
epoch  61 summary: valid_cos_loss : 0.045104, 
epoch  62 summary: valid_cos_loss : 0.044821, 
epoch  63 summary: valid_cos_loss : 0.044677, 
epoch  64 summary: valid_cos_loss : 0.044680, 
epoch  65 summary: valid_cos_loss : 0.044603, 
epoch  66 summary: valid_cos_loss : 0.044549, 
epoch  67 summary: valid_cos_loss : 0.044555, 
epoch  68 summary: valid_cos_loss : 0.044560, 
epoch  69 summary: valid_cos_loss : 0.044483, 
epoch  70 summary: valid_cos_loss : 0.045635, 
valid loss: 2.7722, accuracy: 0.3527
epoch  71 summary: valid_cos_loss : 0.045035, 
epoch  72 summary: valid_cos_loss : 0.044728, 
epoch  73 summary: valid_cos_loss : 0.044592, 
epoch  74 summary: valid_cos_loss : 0.044510, 
epoch  75 summary: valid_cos_loss : 0.044454, 
epoch  76 summary: valid_cos_loss : 0.044487, 
epoch  77 summary: valid_cos_loss : 0.044451, 
epoch  78 summary: valid_cos_loss : 0.044443, 
epoch  79 summary: valid_cos_loss : 0.044422, 
epoch  80 summary: valid_cos_loss : 0.045413, 
valid loss: 2.7846, accuracy: 0.3510
epoch  81 summary: valid_cos_loss : 0.044834, 
epoch  82 summary: valid_cos_loss : 0.044632, 
epoch  83 summary: valid_cos_loss : 0.044512, 
epoch  84 summary: valid_cos_loss : 0.044477, 
epoch  85 summary: valid_cos_loss : 0.044429, 
epoch  86 summary: valid_cos_loss : 0.044408, 
epoch  87 summary: valid_cos_loss : 0.044345, 
epoch  88 summary: valid_cos_loss : 0.044351, 
epoch  89 summary: valid_cos_loss : 0.044343, 
epoch  90 summary: valid_cos_loss : 0.045462, 
valid loss: 2.7899, accuracy: 0.3507
epoch  91 summary: valid_cos_loss : 0.044854, 
epoch  92 summary: valid_cos_loss : 0.044645, 
epoch  93 summary: valid_cos_loss : 0.044546, 
epoch  94 summary: valid_cos_loss : 0.044455, 
epoch  95 summary: valid_cos_loss : 0.044472, 
epoch  96 summary: valid_cos_loss : 0.044421, 
epoch  97 summary: valid_cos_loss : 0.044427, 
epoch  98 summary: valid_cos_loss : 0.044361, 
epoch  99 summary: valid_cos_loss : 0.044363, 
valid loss: 2.7848, accuracy: 0.3511
all                         613705.459ms
all_epoch                   613676.860ms
all_preparation                 28.549ms
all_preparation_2               27.067ms
all_preparation_3                1.461ms
epoch                         5924.723ms
epoch_pos_train                 10.716ms
epoch_preparation                1.422ms
epoch_train                   5871.333ms
epoch_valid                     39.251ms
----------------------------------------
all                         613705.459ms
  all_epoch            100.00%
  all_preparation        0.00%
all_preparation                 28.549ms
  all_preparation_2     94.81%
  all_preparation_3      5.12%
epoch                       592472.257ms
  epoch_train           99.10%
  epoch_valid            0.66%
  epoch_pos_train        0.18%
  epoch_preparation      0.02%
