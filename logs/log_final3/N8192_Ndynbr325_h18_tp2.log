Before CTE Training: train eu loss: 1.0715794563293457, eval eu loss: 1.4517745971679688
Before CTE Training: train eu acc: 0.6578369140625, eval eu acc: 0.5794677734375
epoch   0 summary: train_cos_loss : 0.167573, vocab_cro_loss : 5.289501, 
train loss: 4.7744, accuracy: 0.0299
epoch   1 summary: train_cos_loss : 0.148753, vocab_cro_loss : 4.770764, 
epoch   2 summary: train_cos_loss : 0.116831, vocab_cro_loss : 3.983897, 
epoch   3 summary: train_cos_loss : 0.094372, vocab_cro_loss : 3.396678, 
epoch   4 summary: train_cos_loss : 0.080373, vocab_cro_loss : 3.124831, 
epoch   5 summary: train_cos_loss : 0.071987, vocab_cro_loss : 3.028304, 
epoch   6 summary: train_cos_loss : 0.067010, vocab_cro_loss : 2.954532, 
epoch   7 summary: train_cos_loss : 0.063323, vocab_cro_loss : 2.913625, 
epoch   8 summary: train_cos_loss : 0.060319, vocab_cro_loss : 2.869469, 
epoch   9 summary: train_cos_loss : 0.058354, vocab_cro_loss : 2.855220, 
epoch  10 summary: train_cos_loss : 0.057108, vocab_cro_loss : 2.835493, 
train loss: 2.8339, accuracy: 0.3624
epoch  11 summary: train_cos_loss : 0.055776, vocab_cro_loss : 2.833601, 
epoch  12 summary: train_cos_loss : 0.054439, vocab_cro_loss : 2.814425, 
epoch  13 summary: train_cos_loss : 0.053551, vocab_cro_loss : 2.828634, 
epoch  14 summary: train_cos_loss : 0.052690, vocab_cro_loss : 2.820062, 
epoch  15 summary: train_cos_loss : 0.051959, vocab_cro_loss : 2.792997, 
epoch  16 summary: train_cos_loss : 0.050805, vocab_cro_loss : 2.831117, 
epoch  17 summary: train_cos_loss : 0.049310, vocab_cro_loss : 2.801287, 
epoch  18 summary: train_cos_loss : 0.048142, vocab_cro_loss : 2.788026, 
epoch  19 summary: train_cos_loss : 0.047036, vocab_cro_loss : 2.776911, 
epoch  20 summary: train_cos_loss : 0.045830, vocab_cro_loss : 2.743758, 
train loss: 2.7300, accuracy: 0.3635
epoch  21 summary: train_cos_loss : 0.044680, vocab_cro_loss : 2.729839, 
epoch  22 summary: train_cos_loss : 0.043735, vocab_cro_loss : 2.740186, 
epoch  23 summary: train_cos_loss : 0.042990, vocab_cro_loss : 2.723768, 
epoch  24 summary: train_cos_loss : 0.042328, vocab_cro_loss : 2.718171, 
epoch  25 summary: train_cos_loss : 0.041683, vocab_cro_loss : 2.720456, 
epoch  26 summary: train_cos_loss : 0.041181, vocab_cro_loss : 2.707490, 
epoch  27 summary: train_cos_loss : 0.040759, vocab_cro_loss : 2.697571, 
epoch  28 summary: train_cos_loss : 0.040554, vocab_cro_loss : 2.691352, 
epoch  29 summary: train_cos_loss : 0.040354, vocab_cro_loss : 2.690917, 
epoch  30 summary: train_cos_loss : 0.040082, vocab_cro_loss : 2.681454, 
train loss: 2.6672, accuracy: 0.3826
epoch  31 summary: train_cos_loss : 0.039761, vocab_cro_loss : 2.667119, 
epoch  32 summary: train_cos_loss : 0.039535, vocab_cro_loss : 2.657238, 
epoch  33 summary: train_cos_loss : 0.039452, vocab_cro_loss : 2.654897, 
epoch  34 summary: train_cos_loss : 0.039356, vocab_cro_loss : 2.654630, 
epoch  35 summary: train_cos_loss : 0.039277, vocab_cro_loss : 2.650380, 
epoch  36 summary: train_cos_loss : 0.039218, vocab_cro_loss : 2.650967, 
epoch  37 summary: train_cos_loss : 0.039080, vocab_cro_loss : 2.647654, 
epoch  38 summary: train_cos_loss : 0.039029, vocab_cro_loss : 2.635602, 
epoch  39 summary: train_cos_loss : 0.038918, vocab_cro_loss : 2.632561, 
epoch  40 summary: train_cos_loss : 0.038868, vocab_cro_loss : 2.628040, 
train loss: 2.6278, accuracy: 0.3984
epoch  41 summary: train_cos_loss : 0.038773, vocab_cro_loss : 2.627829, 
epoch  42 summary: train_cos_loss : 0.038696, vocab_cro_loss : 2.631647, 
epoch  43 summary: train_cos_loss : 0.038441, vocab_cro_loss : 2.631028, 
epoch  44 summary: train_cos_loss : 0.038271, vocab_cro_loss : 2.632041, 
epoch  45 summary: train_cos_loss : 0.038236, vocab_cro_loss : 2.633055, 
epoch  46 summary: train_cos_loss : 0.038127, vocab_cro_loss : 2.639032, 
epoch  47 summary: train_cos_loss : 0.038170, vocab_cro_loss : 2.641286, 
epoch  48 summary: train_cos_loss : 0.038077, vocab_cro_loss : 2.641366, 
epoch  49 summary: train_cos_loss : 0.038037, vocab_cro_loss : 2.634527, 
epoch  50 summary: train_cos_loss : 0.038001, vocab_cro_loss : 2.629681, 
train loss: 2.6295, accuracy: 0.3951
epoch  51 summary: train_cos_loss : 0.037895, vocab_cro_loss : 2.629438, 
epoch  52 summary: train_cos_loss : 0.037773, vocab_cro_loss : 2.626383, 
epoch  53 summary: train_cos_loss : 0.037747, vocab_cro_loss : 2.623468, 
epoch  54 summary: train_cos_loss : 0.037645, vocab_cro_loss : 2.625493, 
epoch  55 summary: train_cos_loss : 0.037584, vocab_cro_loss : 2.624799, 
epoch  56 summary: train_cos_loss : 0.037485, vocab_cro_loss : 2.623587, 
epoch  57 summary: train_cos_loss : 0.037461, vocab_cro_loss : 2.620634, 
epoch  58 summary: train_cos_loss : 0.037449, vocab_cro_loss : 2.619756, 
epoch  59 summary: train_cos_loss : 0.037468, vocab_cro_loss : 2.619140, 
epoch  60 summary: train_cos_loss : 0.037462, vocab_cro_loss : 2.617812, 
train loss: 2.6141, accuracy: 0.3955
epoch  61 summary: train_cos_loss : 0.037409, vocab_cro_loss : 2.614099, 
epoch  62 summary: train_cos_loss : 0.037314, vocab_cro_loss : 2.611616, 
epoch  63 summary: train_cos_loss : 0.037317, vocab_cro_loss : 2.613179, 
epoch  64 summary: train_cos_loss : 0.037273, vocab_cro_loss : 2.612191, 
epoch  65 summary: train_cos_loss : 0.037254, vocab_cro_loss : 2.612455, 
epoch  66 summary: train_cos_loss : 0.037249, vocab_cro_loss : 2.611654, 
epoch  67 summary: train_cos_loss : 0.037273, vocab_cro_loss : 2.608415, 
epoch  68 summary: train_cos_loss : 0.037196, vocab_cro_loss : 2.608805, 
epoch  69 summary: train_cos_loss : 0.037224, vocab_cro_loss : 2.606918, 
epoch  70 summary: train_cos_loss : 0.037320, vocab_cro_loss : 2.602152, 
train loss: 2.6017, accuracy: 0.3989
epoch  71 summary: train_cos_loss : 0.037203, vocab_cro_loss : 2.601721, 
epoch  72 summary: train_cos_loss : 0.036965, vocab_cro_loss : 2.595047, 
epoch  73 summary: train_cos_loss : 0.036739, vocab_cro_loss : 2.593802, 
epoch  74 summary: train_cos_loss : 0.036584, vocab_cro_loss : 2.588562, 
epoch  75 summary: train_cos_loss : 0.036389, vocab_cro_loss : 2.587056, 
epoch  76 summary: train_cos_loss : 0.036281, vocab_cro_loss : 2.585306, 
epoch  77 summary: train_cos_loss : 0.036147, vocab_cro_loss : 2.584107, 
epoch  78 summary: train_cos_loss : 0.036061, vocab_cro_loss : 2.578686, 
epoch  79 summary: train_cos_loss : 0.035971, vocab_cro_loss : 2.578833, 
epoch  80 summary: train_cos_loss : 0.036011, vocab_cro_loss : 2.578690, 
train loss: 2.5778, accuracy: 0.4052
epoch  81 summary: train_cos_loss : 0.035919, vocab_cro_loss : 2.577783, 
epoch  82 summary: train_cos_loss : 0.035835, vocab_cro_loss : 2.576191, 
epoch  83 summary: train_cos_loss : 0.035807, vocab_cro_loss : 2.575031, 
epoch  84 summary: train_cos_loss : 0.035783, vocab_cro_loss : 2.575730, 
epoch  85 summary: train_cos_loss : 0.035761, vocab_cro_loss : 2.574747, 
epoch  86 summary: train_cos_loss : 0.035739, vocab_cro_loss : 2.571513, 
epoch  87 summary: train_cos_loss : 0.035743, vocab_cro_loss : 2.571667, 
epoch  88 summary: train_cos_loss : 0.035715, vocab_cro_loss : 2.569772, 
epoch  89 summary: train_cos_loss : 0.035705, vocab_cro_loss : 2.569713, 
epoch  90 summary: train_cos_loss : 0.035714, vocab_cro_loss : 2.569296, 
train loss: 2.5703, accuracy: 0.4088
epoch  91 summary: train_cos_loss : 0.035678, vocab_cro_loss : 2.570295, 
epoch  92 summary: train_cos_loss : 0.035688, vocab_cro_loss : 2.568483, 
epoch  93 summary: train_cos_loss : 0.035676, vocab_cro_loss : 2.569314, 
epoch  94 summary: train_cos_loss : 0.035641, vocab_cro_loss : 2.565670, 
epoch  95 summary: train_cos_loss : 0.035589, vocab_cro_loss : 2.563184, 
epoch  96 summary: train_cos_loss : 0.035528, vocab_cro_loss : 2.559966, 
epoch  97 summary: train_cos_loss : 0.035494, vocab_cro_loss : 2.557059, 
epoch  98 summary: train_cos_loss : 0.035447, vocab_cro_loss : 2.558679, 
epoch  99 summary: train_cos_loss : 0.035407, vocab_cro_loss : 2.555809, 
train loss: 2.5578, accuracy: 0.4102
all                         748664.077ms
all_epoch                   742548.504ms
all_preparation               6115.535ms
all_preparation_2             6112.723ms
all_preparation_3                2.763ms
epoch                         7063.573ms
epoch_pos_train                 10.148ms
epoch_preparation               20.957ms
epoch_train                   6981.150ms
epoch_valid                     48.117ms
----------------------------------------
all                         748664.077ms
  all_epoch             99.18%
  all_preparation        0.82%
all_preparation               6115.535ms
  all_preparation_2     99.95%
  all_preparation_3      0.05%
epoch                       706357.267ms
  epoch_train           98.83%
  epoch_valid            0.68%
  epoch_preparation      0.30%
  epoch_pos_train        0.14%
epoch   0 summary: valid_cos_loss : 0.230533, 
valid loss: 3.4545, accuracy: 0.2295
epoch   1 summary: valid_cos_loss : 0.125457, 
epoch   2 summary: valid_cos_loss : 0.081466, 
epoch   3 summary: valid_cos_loss : 0.062417, 
epoch   4 summary: valid_cos_loss : 0.053743, 
epoch   5 summary: valid_cos_loss : 0.049577, 
epoch   6 summary: valid_cos_loss : 0.047531, 
epoch   7 summary: valid_cos_loss : 0.046454, 
epoch   8 summary: valid_cos_loss : 0.045886, 
epoch   9 summary: valid_cos_loss : 0.045505, 
epoch  10 summary: valid_cos_loss : 0.045808, 
valid loss: 2.9608, accuracy: 0.3228
epoch  11 summary: valid_cos_loss : 0.045256, 
epoch  12 summary: valid_cos_loss : 0.044970, 
epoch  13 summary: valid_cos_loss : 0.044773, 
epoch  14 summary: valid_cos_loss : 0.044564, 
epoch  15 summary: valid_cos_loss : 0.044511, 
epoch  16 summary: valid_cos_loss : 0.044448, 
epoch  17 summary: valid_cos_loss : 0.044359, 
epoch  18 summary: valid_cos_loss : 0.044292, 
epoch  19 summary: valid_cos_loss : 0.044201, 
epoch  20 summary: valid_cos_loss : 0.044739, 
valid loss: 2.9654, accuracy: 0.3230
epoch  21 summary: valid_cos_loss : 0.044427, 
epoch  22 summary: valid_cos_loss : 0.044266, 
epoch  23 summary: valid_cos_loss : 0.044102, 
epoch  24 summary: valid_cos_loss : 0.043995, 
epoch  25 summary: valid_cos_loss : 0.043952, 
epoch  26 summary: valid_cos_loss : 0.043970, 
epoch  27 summary: valid_cos_loss : 0.043930, 
epoch  28 summary: valid_cos_loss : 0.043839, 
epoch  29 summary: valid_cos_loss : 0.043804, 
epoch  30 summary: valid_cos_loss : 0.044406, 
valid loss: 2.9687, accuracy: 0.3214
epoch  31 summary: valid_cos_loss : 0.044021, 
epoch  32 summary: valid_cos_loss : 0.043890, 
epoch  33 summary: valid_cos_loss : 0.043860, 
epoch  34 summary: valid_cos_loss : 0.043796, 
epoch  35 summary: valid_cos_loss : 0.043727, 
epoch  36 summary: valid_cos_loss : 0.043751, 
epoch  37 summary: valid_cos_loss : 0.043679, 
epoch  38 summary: valid_cos_loss : 0.043702, 
epoch  39 summary: valid_cos_loss : 0.043639, 
epoch  40 summary: valid_cos_loss : 0.044293, 
valid loss: 2.9740, accuracy: 0.3218
epoch  41 summary: valid_cos_loss : 0.043994, 
epoch  42 summary: valid_cos_loss : 0.043769, 
epoch  43 summary: valid_cos_loss : 0.043665, 
epoch  44 summary: valid_cos_loss : 0.043644, 
epoch  45 summary: valid_cos_loss : 0.043612, 
epoch  46 summary: valid_cos_loss : 0.043575, 
epoch  47 summary: valid_cos_loss : 0.043604, 
epoch  48 summary: valid_cos_loss : 0.043566, 
epoch  49 summary: valid_cos_loss : 0.043552, 
epoch  50 summary: valid_cos_loss : 0.044048, 
valid loss: 2.9719, accuracy: 0.3230
epoch  51 summary: valid_cos_loss : 0.043789, 
epoch  52 summary: valid_cos_loss : 0.043624, 
epoch  53 summary: valid_cos_loss : 0.043528, 
epoch  54 summary: valid_cos_loss : 0.043560, 
epoch  55 summary: valid_cos_loss : 0.043443, 
epoch  56 summary: valid_cos_loss : 0.043403, 
epoch  57 summary: valid_cos_loss : 0.043428, 
epoch  58 summary: valid_cos_loss : 0.043410, 
epoch  59 summary: valid_cos_loss : 0.043402, 
epoch  60 summary: valid_cos_loss : 0.043819, 
valid loss: 2.9694, accuracy: 0.3242
epoch  61 summary: valid_cos_loss : 0.043559, 
epoch  62 summary: valid_cos_loss : 0.043444, 
epoch  63 summary: valid_cos_loss : 0.043409, 
epoch  64 summary: valid_cos_loss : 0.043366, 
epoch  65 summary: valid_cos_loss : 0.043273, 
epoch  66 summary: valid_cos_loss : 0.043303, 
epoch  67 summary: valid_cos_loss : 0.043227, 
epoch  68 summary: valid_cos_loss : 0.043271, 
epoch  69 summary: valid_cos_loss : 0.043244, 
epoch  70 summary: valid_cos_loss : 0.043743, 
valid loss: 2.9713, accuracy: 0.3215
epoch  71 summary: valid_cos_loss : 0.043531, 
epoch  72 summary: valid_cos_loss : 0.043377, 
epoch  73 summary: valid_cos_loss : 0.043312, 
epoch  74 summary: valid_cos_loss : 0.043273, 
epoch  75 summary: valid_cos_loss : 0.043279, 
epoch  76 summary: valid_cos_loss : 0.043280, 
epoch  77 summary: valid_cos_loss : 0.043217, 
epoch  78 summary: valid_cos_loss : 0.043238, 
epoch  79 summary: valid_cos_loss : 0.043224, 
epoch  80 summary: valid_cos_loss : 0.043757, 
valid loss: 2.9696, accuracy: 0.3212
epoch  81 summary: valid_cos_loss : 0.043413, 
epoch  82 summary: valid_cos_loss : 0.043310, 
epoch  83 summary: valid_cos_loss : 0.043276, 
epoch  84 summary: valid_cos_loss : 0.043262, 
epoch  85 summary: valid_cos_loss : 0.043283, 
epoch  86 summary: valid_cos_loss : 0.043205, 
epoch  87 summary: valid_cos_loss : 0.043258, 
epoch  88 summary: valid_cos_loss : 0.043208, 
epoch  89 summary: valid_cos_loss : 0.043214, 
epoch  90 summary: valid_cos_loss : 0.043731, 
valid loss: 2.9721, accuracy: 0.3219
epoch  91 summary: valid_cos_loss : 0.043413, 
epoch  92 summary: valid_cos_loss : 0.043316, 
epoch  93 summary: valid_cos_loss : 0.043261, 
epoch  94 summary: valid_cos_loss : 0.043256, 
epoch  95 summary: valid_cos_loss : 0.043277, 
epoch  96 summary: valid_cos_loss : 0.043212, 
epoch  97 summary: valid_cos_loss : 0.043218, 
epoch  98 summary: valid_cos_loss : 0.043195, 
epoch  99 summary: valid_cos_loss : 0.043177, 
valid loss: 2.9663, accuracy: 0.3223
all                         715113.453ms
all_epoch                   715077.231ms
all_preparation                 36.177ms
all_preparation_2               35.184ms
all_preparation_3                0.973ms
epoch                         6916.482ms
epoch_pos_train                  5.987ms
epoch_preparation                1.569ms
epoch_train                   6872.799ms
epoch_valid                     34.263ms
----------------------------------------
all                         715113.453ms
  all_epoch             99.99%
  all_preparation        0.01%
all_preparation                 36.177ms
  all_preparation_2     97.25%
  all_preparation_3      2.69%
epoch                       691648.154ms
  epoch_train           99.37%
  epoch_valid            0.50%
  epoch_pos_train        0.09%
  epoch_preparation      0.02%
