Before CTE Training: train eu loss: 1.0715794563293457, eval eu loss: 1.4517745971679688
Before CTE Training: train eu acc: 0.6578369140625, eval eu acc: 0.5794677734375
epoch   0 summary: train_cos_loss : 0.177985, vocab_cro_loss : 4.411092, 
train loss: 4.2551, accuracy: 0.0310
epoch   1 summary: train_cos_loss : 0.169745, vocab_cro_loss : 4.254707, 
epoch   2 summary: train_cos_loss : 0.152385, vocab_cro_loss : 3.796415, 
epoch   3 summary: train_cos_loss : 0.130159, vocab_cro_loss : 3.243985, 
epoch   4 summary: train_cos_loss : 0.108342, vocab_cro_loss : 2.846435, 
epoch   5 summary: train_cos_loss : 0.089449, vocab_cro_loss : 2.607575, 
epoch   6 summary: train_cos_loss : 0.074300, vocab_cro_loss : 2.390896, 
epoch   7 summary: train_cos_loss : 0.062496, vocab_cro_loss : 2.212444, 
epoch   8 summary: train_cos_loss : 0.053655, vocab_cro_loss : 2.107513, 
epoch   9 summary: train_cos_loss : 0.046864, vocab_cro_loss : 2.035558, 
epoch  10 summary: train_cos_loss : 0.041842, vocab_cro_loss : 1.989549, 
train loss: 1.9370, accuracy: 0.4983
epoch  11 summary: train_cos_loss : 0.037856, vocab_cro_loss : 1.936773, 
epoch  12 summary: train_cos_loss : 0.034198, vocab_cro_loss : 1.876491, 
epoch  13 summary: train_cos_loss : 0.031582, vocab_cro_loss : 1.863904, 
epoch  14 summary: train_cos_loss : 0.029288, vocab_cro_loss : 1.834203, 
epoch  15 summary: train_cos_loss : 0.027408, vocab_cro_loss : 1.831671, 
epoch  16 summary: train_cos_loss : 0.025781, vocab_cro_loss : 1.824875, 
epoch  17 summary: train_cos_loss : 0.024568, vocab_cro_loss : 1.794903, 
epoch  18 summary: train_cos_loss : 0.023289, vocab_cro_loss : 1.776038, 
epoch  19 summary: train_cos_loss : 0.022346, vocab_cro_loss : 1.770867, 
epoch  20 summary: train_cos_loss : 0.021828, vocab_cro_loss : 1.750758, 
train loss: 1.7125, accuracy: 0.5310
epoch  21 summary: train_cos_loss : 0.020957, vocab_cro_loss : 1.712402, 
epoch  22 summary: train_cos_loss : 0.020332, vocab_cro_loss : 1.712901, 
epoch  23 summary: train_cos_loss : 0.019690, vocab_cro_loss : 1.738656, 
epoch  24 summary: train_cos_loss : 0.019336, vocab_cro_loss : 1.729641, 
epoch  25 summary: train_cos_loss : 0.018830, vocab_cro_loss : 1.731951, 
epoch  26 summary: train_cos_loss : 0.018461, vocab_cro_loss : 1.750764, 
epoch  27 summary: train_cos_loss : 0.018269, vocab_cro_loss : 1.797909, 
epoch  28 summary: train_cos_loss : 0.018041, vocab_cro_loss : 1.780217, 
epoch  29 summary: train_cos_loss : 0.017590, vocab_cro_loss : 1.718283, 
epoch  30 summary: train_cos_loss : 0.017392, vocab_cro_loss : 1.710159, 
train loss: 1.7679, accuracy: 0.5327
epoch  31 summary: train_cos_loss : 0.017236, vocab_cro_loss : 1.767240, 
epoch  32 summary: train_cos_loss : 0.016972, vocab_cro_loss : 1.737461, 
epoch  33 summary: train_cos_loss : 0.016808, vocab_cro_loss : 2.083606, 
epoch  34 summary: train_cos_loss : 0.017003, vocab_cro_loss : 1.976118, 
epoch  35 summary: train_cos_loss : 0.016750, vocab_cro_loss : 1.896682, 
epoch  36 summary: train_cos_loss : 0.016491, vocab_cro_loss : 1.799139, 
epoch  37 summary: train_cos_loss : 0.016351, vocab_cro_loss : 1.807478, 
epoch  38 summary: train_cos_loss : 0.016320, vocab_cro_loss : 1.873131, 
epoch  39 summary: train_cos_loss : 0.016167, vocab_cro_loss : 1.864699, 
epoch  40 summary: train_cos_loss : 0.016256, vocab_cro_loss : 1.812476, 
train loss: 1.8344, accuracy: 0.5277
epoch  41 summary: train_cos_loss : 0.016097, vocab_cro_loss : 1.834100, 
epoch  42 summary: train_cos_loss : 0.015908, vocab_cro_loss : 1.770748, 
epoch  43 summary: train_cos_loss : 0.015771, vocab_cro_loss : 1.861990, 
epoch  44 summary: train_cos_loss : 0.015757, vocab_cro_loss : 1.835004, 
epoch  45 summary: train_cos_loss : 0.016053, vocab_cro_loss : 2.076878, 
epoch  46 summary: train_cos_loss : 0.016203, vocab_cro_loss : 1.989653, 
epoch  47 summary: train_cos_loss : 0.016265, vocab_cro_loss : 1.900371, 
epoch  48 summary: train_cos_loss : 0.016190, vocab_cro_loss : 1.839942, 
epoch  49 summary: train_cos_loss : 0.016043, vocab_cro_loss : 1.817559, 
epoch  50 summary: train_cos_loss : 0.016059, vocab_cro_loss : 1.819303, 
train loss: 1.7673, accuracy: 0.5250
epoch  51 summary: train_cos_loss : 0.015965, vocab_cro_loss : 1.767061, 
epoch  52 summary: train_cos_loss : 0.015835, vocab_cro_loss : 1.745065, 
epoch  53 summary: train_cos_loss : 0.015739, vocab_cro_loss : 1.738547, 
epoch  54 summary: train_cos_loss : 0.015644, vocab_cro_loss : 1.749015, 
epoch  55 summary: train_cos_loss : 0.015549, vocab_cro_loss : 1.722271, 
epoch  56 summary: train_cos_loss : 0.015539, vocab_cro_loss : 1.766469, 
epoch  57 summary: train_cos_loss : 0.015567, vocab_cro_loss : 1.762760, 
epoch  58 summary: train_cos_loss : 0.015459, vocab_cro_loss : 1.745576, 
epoch  59 summary: train_cos_loss : 0.015399, vocab_cro_loss : 1.763073, 
epoch  60 summary: train_cos_loss : 0.015441, vocab_cro_loss : 1.736839, 
train loss: 1.7810, accuracy: 0.5345
epoch  61 summary: train_cos_loss : 0.015463, vocab_cro_loss : 1.780656, 
epoch  62 summary: train_cos_loss : 0.015345, vocab_cro_loss : 1.762840, 
epoch  63 summary: train_cos_loss : 0.015238, vocab_cro_loss : 1.718609, 
epoch  64 summary: train_cos_loss : 0.015120, vocab_cro_loss : 1.754055, 
epoch  65 summary: train_cos_loss : 0.015022, vocab_cro_loss : 1.726625, 
epoch  66 summary: train_cos_loss : 0.014946, vocab_cro_loss : 1.708505, 
epoch  67 summary: train_cos_loss : 0.014932, vocab_cro_loss : 1.712591, 
epoch  68 summary: train_cos_loss : 0.014807, vocab_cro_loss : 1.726180, 
epoch  69 summary: train_cos_loss : 0.014754, vocab_cro_loss : 1.743933, 
epoch  70 summary: train_cos_loss : 0.014827, vocab_cro_loss : 1.736748, 
train loss: 1.8106, accuracy: 0.5095
epoch  71 summary: train_cos_loss : 0.015057, vocab_cro_loss : 1.809746, 
epoch  72 summary: train_cos_loss : 0.015121, vocab_cro_loss : 1.819008, 
epoch  73 summary: train_cos_loss : 0.014990, vocab_cro_loss : 1.762470, 
epoch  74 summary: train_cos_loss : 0.015091, vocab_cro_loss : 1.709373, 
epoch  75 summary: train_cos_loss : 0.014968, vocab_cro_loss : 1.705972, 
epoch  76 summary: train_cos_loss : 0.014924, vocab_cro_loss : 1.731115, 
epoch  77 summary: train_cos_loss : 0.014904, vocab_cro_loss : 1.726025, 
epoch  78 summary: train_cos_loss : 0.014893, vocab_cro_loss : 1.729468, 
epoch  79 summary: train_cos_loss : 0.014798, vocab_cro_loss : 1.747754, 
epoch  80 summary: train_cos_loss : 0.014931, vocab_cro_loss : 1.676388, 
train loss: 1.7408, accuracy: 0.5273
epoch  81 summary: train_cos_loss : 0.014855, vocab_cro_loss : 1.740164, 
epoch  82 summary: train_cos_loss : 0.014800, vocab_cro_loss : 1.765323, 
epoch  83 summary: train_cos_loss : 0.014893, vocab_cro_loss : 1.707854, 
epoch  84 summary: train_cos_loss : 0.014738, vocab_cro_loss : 1.785949, 
epoch  85 summary: train_cos_loss : 0.014694, vocab_cro_loss : 1.739053, 
epoch  86 summary: train_cos_loss : 0.014666, vocab_cro_loss : 1.692394, 
epoch  87 summary: train_cos_loss : 0.014504, vocab_cro_loss : 1.666018, 
epoch  88 summary: train_cos_loss : 0.014522, vocab_cro_loss : 1.654763, 
epoch  89 summary: train_cos_loss : 0.014383, vocab_cro_loss : 1.677399, 
epoch  90 summary: train_cos_loss : 0.014415, vocab_cro_loss : 1.898880, 
train loss: 1.8320, accuracy: 0.5262
epoch  91 summary: train_cos_loss : 0.014577, vocab_cro_loss : 1.831462, 
epoch  92 summary: train_cos_loss : 0.014534, vocab_cro_loss : 1.729637, 
epoch  93 summary: train_cos_loss : 0.014521, vocab_cro_loss : 1.738124, 
epoch  94 summary: train_cos_loss : 0.014337, vocab_cro_loss : 1.698387, 
epoch  95 summary: train_cos_loss : 0.014181, vocab_cro_loss : 1.652956, 
epoch  96 summary: train_cos_loss : 0.014147, vocab_cro_loss : 1.677209, 
epoch  97 summary: train_cos_loss : 0.014089, vocab_cro_loss : 1.689107, 
epoch  98 summary: train_cos_loss : 0.013989, vocab_cro_loss : 1.694871, 
epoch  99 summary: train_cos_loss : 0.014027, vocab_cro_loss : 1.697899, 
train loss: 1.7613, accuracy: 0.5259
all                         678653.792ms
all_epoch                   673966.802ms
all_preparation               4686.941ms
all_preparation_2             4684.458ms
all_preparation_3                2.446ms
epoch                         6328.402ms
epoch_pos_train                  6.774ms
epoch_preparation               35.279ms
epoch_train                   6252.179ms
epoch_valid                     31.481ms
----------------------------------------
all                         678653.792ms
  all_epoch             99.31%
  all_preparation        0.69%
all_preparation               4686.941ms
  all_preparation_2     99.95%
  all_preparation_3      0.05%
epoch                       632840.181ms
  epoch_train           98.80%
  epoch_preparation      0.56%
  epoch_valid            0.50%
  epoch_pos_train        0.11%
epoch   0 summary: valid_cos_loss : 0.254579, 
valid loss: 3.4542, accuracy: 0.1896
epoch   1 summary: valid_cos_loss : 0.157096, 
epoch   2 summary: valid_cos_loss : 0.104442, 
epoch   3 summary: valid_cos_loss : 0.072524, 
epoch   4 summary: valid_cos_loss : 0.053336, 
epoch   5 summary: valid_cos_loss : 0.041456, 
epoch   6 summary: valid_cos_loss : 0.033761, 
epoch   7 summary: valid_cos_loss : 0.028654, 
epoch   8 summary: valid_cos_loss : 0.025545, 
epoch   9 summary: valid_cos_loss : 0.023397, 
epoch  10 summary: valid_cos_loss : 0.021975, 
valid loss: 2.2570, accuracy: 0.4312
epoch  11 summary: valid_cos_loss : 0.020869, 
epoch  12 summary: valid_cos_loss : 0.019994, 
epoch  13 summary: valid_cos_loss : 0.019206, 
epoch  14 summary: valid_cos_loss : 0.018690, 
epoch  15 summary: valid_cos_loss : 0.018280, 
epoch  16 summary: valid_cos_loss : 0.017904, 
epoch  17 summary: valid_cos_loss : 0.017647, 
epoch  18 summary: valid_cos_loss : 0.017400, 
epoch  19 summary: valid_cos_loss : 0.017344, 
epoch  20 summary: valid_cos_loss : 0.017299, 
valid loss: 2.2377, accuracy: 0.4393
epoch  21 summary: valid_cos_loss : 0.017178, 
epoch  22 summary: valid_cos_loss : 0.016998, 
epoch  23 summary: valid_cos_loss : 0.016873, 
epoch  24 summary: valid_cos_loss : 0.016804, 
epoch  25 summary: valid_cos_loss : 0.016768, 
epoch  26 summary: valid_cos_loss : 0.016611, 
epoch  27 summary: valid_cos_loss : 0.016569, 
epoch  28 summary: valid_cos_loss : 0.016465, 
epoch  29 summary: valid_cos_loss : 0.016482, 
epoch  30 summary: valid_cos_loss : 0.016601, 
valid loss: 2.2403, accuracy: 0.4379
epoch  31 summary: valid_cos_loss : 0.016490, 
epoch  32 summary: valid_cos_loss : 0.016431, 
epoch  33 summary: valid_cos_loss : 0.016403, 
epoch  34 summary: valid_cos_loss : 0.016347, 
epoch  35 summary: valid_cos_loss : 0.016278, 
epoch  36 summary: valid_cos_loss : 0.016225, 
epoch  37 summary: valid_cos_loss : 0.016260, 
epoch  38 summary: valid_cos_loss : 0.016187, 
epoch  39 summary: valid_cos_loss : 0.016193, 
epoch  40 summary: valid_cos_loss : 0.016275, 
valid loss: 2.2382, accuracy: 0.4379
epoch  41 summary: valid_cos_loss : 0.016182, 
epoch  42 summary: valid_cos_loss : 0.016175, 
epoch  43 summary: valid_cos_loss : 0.016142, 
epoch  44 summary: valid_cos_loss : 0.016139, 
epoch  45 summary: valid_cos_loss : 0.016084, 
epoch  46 summary: valid_cos_loss : 0.016079, 
epoch  47 summary: valid_cos_loss : 0.016047, 
epoch  48 summary: valid_cos_loss : 0.015967, 
epoch  49 summary: valid_cos_loss : 0.015944, 
epoch  50 summary: valid_cos_loss : 0.016059, 
valid loss: 2.2347, accuracy: 0.4395
epoch  51 summary: valid_cos_loss : 0.015985, 
epoch  52 summary: valid_cos_loss : 0.015946, 
epoch  53 summary: valid_cos_loss : 0.015918, 
epoch  54 summary: valid_cos_loss : 0.015888, 
epoch  55 summary: valid_cos_loss : 0.015896, 
epoch  56 summary: valid_cos_loss : 0.015848, 
epoch  57 summary: valid_cos_loss : 0.015865, 
epoch  58 summary: valid_cos_loss : 0.015855, 
epoch  59 summary: valid_cos_loss : 0.015836, 
epoch  60 summary: valid_cos_loss : 0.015956, 
valid loss: 2.2354, accuracy: 0.4395
epoch  61 summary: valid_cos_loss : 0.015956, 
epoch  62 summary: valid_cos_loss : 0.015877, 
epoch  63 summary: valid_cos_loss : 0.015839, 
epoch  64 summary: valid_cos_loss : 0.015844, 
epoch  65 summary: valid_cos_loss : 0.015825, 
epoch  66 summary: valid_cos_loss : 0.015836, 
epoch  67 summary: valid_cos_loss : 0.015813, 
epoch  68 summary: valid_cos_loss : 0.015768, 
epoch  69 summary: valid_cos_loss : 0.015738, 
epoch  70 summary: valid_cos_loss : 0.015841, 
valid loss: 2.2333, accuracy: 0.4412
epoch  71 summary: valid_cos_loss : 0.015809, 
epoch  72 summary: valid_cos_loss : 0.015737, 
epoch  73 summary: valid_cos_loss : 0.015714, 
epoch  74 summary: valid_cos_loss : 0.015692, 
epoch  75 summary: valid_cos_loss : 0.015653, 
epoch  76 summary: valid_cos_loss : 0.015661, 
epoch  77 summary: valid_cos_loss : 0.015602, 
epoch  78 summary: valid_cos_loss : 0.015625, 
epoch  79 summary: valid_cos_loss : 0.015610, 
epoch  80 summary: valid_cos_loss : 0.015720, 
valid loss: 2.2342, accuracy: 0.4390
epoch  81 summary: valid_cos_loss : 0.015707, 
epoch  82 summary: valid_cos_loss : 0.015678, 
epoch  83 summary: valid_cos_loss : 0.015661, 
epoch  84 summary: valid_cos_loss : 0.015645, 
epoch  85 summary: valid_cos_loss : 0.015639, 
epoch  86 summary: valid_cos_loss : 0.015620, 
epoch  87 summary: valid_cos_loss : 0.015644, 
epoch  88 summary: valid_cos_loss : 0.015605, 
epoch  89 summary: valid_cos_loss : 0.015572, 
epoch  90 summary: valid_cos_loss : 0.015664, 
valid loss: 2.2352, accuracy: 0.4384
epoch  91 summary: valid_cos_loss : 0.015623, 
epoch  92 summary: valid_cos_loss : 0.015628, 
epoch  93 summary: valid_cos_loss : 0.015611, 
epoch  94 summary: valid_cos_loss : 0.015581, 
epoch  95 summary: valid_cos_loss : 0.015564, 
epoch  96 summary: valid_cos_loss : 0.015578, 
epoch  97 summary: valid_cos_loss : 0.015579, 
epoch  98 summary: valid_cos_loss : 0.015524, 
epoch  99 summary: valid_cos_loss : 0.015527, 
valid loss: 2.2321, accuracy: 0.4398
all                         605850.323ms
all_epoch                   605790.693ms
all_preparation                 59.587ms
all_preparation_2               44.255ms
all_preparation_3               15.299ms
epoch                         5807.810ms
epoch_pos_train                  6.134ms
epoch_preparation                0.888ms
epoch_train                   5766.734ms
epoch_valid                     32.651ms
----------------------------------------
all                         605850.323ms
  all_epoch             99.99%
  all_preparation        0.01%
all_preparation                 59.587ms
  all_preparation_2     74.27%
  all_preparation_3     25.67%
epoch                       580781.018ms
  epoch_train           99.29%
  epoch_valid            0.56%
  epoch_pos_train        0.11%
  epoch_preparation      0.02%
