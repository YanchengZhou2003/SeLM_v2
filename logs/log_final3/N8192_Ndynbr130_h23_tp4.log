Traceback (most recent call last):
  File "/data3/gc/SeLM_v2/src/utils.py", line 1341, in wrapper
    return func(*args, **kwargs)
  File "/data3/gc/SeLM_v2/src/cte.py", line 561, in train_epoch
    self.train_vocab_blocks(sid)
  File "/data3/gc/SeLM_v2/src/cte.py", line 468, in train_vocab_blocks
    loss  = self.loom_vocab(
  File "/data3/gc/SeLM_v2/src/cte.py", line 227, in loom_vocab
    cos_nei_cnc = self.cos_similarity(pos_loc[:, None, None, :], cnc_loc[None, :, :, :])
  File "/data3/gc/SeLM_v2/src/cte.py", line 137, in cos_similarity
    xor_result = torch.abs(coord1) ^ torch.abs(coord2)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 68.00 MiB. GPU 2 has a total capacity of 23.69 GiB of which 30.69 MiB is free. Process 97318 has 444.00 MiB memory in use. Process 97333 has 654.00 MiB memory in use. Process 97351 has 678.00 MiB memory in use. Process 97312 has 522.00 MiB memory in use. Process 97337 has 582.00 MiB memory in use. Process 97330 has 538.00 MiB memory in use. Process 97341 has 506.00 MiB memory in use. Process 97332 has 454.00 MiB memory in use. Process 97310 has 554.00 MiB memory in use. Process 97327 has 444.00 MiB memory in use. Process 97309 has 438.00 MiB memory in use. Process 97316 has 962.00 MiB memory in use. Process 97329 has 418.00 MiB memory in use. Process 97350 has 512.00 MiB memory in use. Process 97346 has 388.00 MiB memory in use. Process 97338 has 430.00 MiB memory in use. Process 97349 has 760.00 MiB memory in use. Process 97314 has 472.00 MiB memory in use. Process 97339 has 544.00 MiB memory in use. Process 97325 has 984.00 MiB memory in use. Process 97352 has 1.00 GiB memory in use. Including non-PyTorch memory, this process has 346.00 MiB memory in use. Process 97328 has 576.00 MiB memory in use. Process 97322 has 734.00 MiB memory in use. Process 97343 has 460.00 MiB memory in use. Process 97311 has 410.00 MiB memory in use. Process 97334 has 974.00 MiB memory in use. Process 97320 has 418.00 MiB memory in use. Process 97348 has 418.00 MiB memory in use. Process 97336 has 348.00 MiB memory in use. Process 97308 has 378.00 MiB memory in use. Process 97331 has 394.00 MiB memory in use. Process 97340 has 742.00 MiB memory in use. Process 97323 has 472.00 MiB memory in use. Process 97319 has 548.00 MiB memory in use. Process 97326 has 348.00 MiB memory in use. Process 97335 has 348.00 MiB memory in use. Process 97313 has 724.00 MiB memory in use. Process 97344 has 382.00 MiB memory in use. Process 97321 has 522.00 MiB memory in use. Process 97317 has 376.00 MiB memory in use. Process 97315 has 622.00 MiB memory in use. Process 97347 has 328.00 MiB memory in use. Process 97345 has 368.00 MiB memory in use. Process 97342 has 530.00 MiB memory in use. Of the allocated memory 30.29 MiB is allocated by PyTorch, and 9.71 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
