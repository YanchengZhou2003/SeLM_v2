Before CTE Training: train eu loss: 1.057024359703064, eval eu loss: 1.4517745971679688
Before CTE Training: train eu acc: 0.66552734375, eval eu acc: 0.5794677734375
epoch   0 summary: train_cos_loss : 0.072623, vocab_cro_loss : 4.413658, 
train loss: 4.1927, accuracy: 0.0493
epoch   1 summary: train_cos_loss : 0.068473, vocab_cro_loss : 4.192202, 
epoch   2 summary: train_cos_loss : 0.061065, vocab_cro_loss : 3.700650, 
epoch   3 summary: train_cos_loss : 0.052024, vocab_cro_loss : 3.136904, 
epoch   4 summary: train_cos_loss : 0.043397, vocab_cro_loss : 2.714062, 
epoch   5 summary: train_cos_loss : 0.035807, vocab_cro_loss : 2.484080, 
epoch   6 summary: train_cos_loss : 0.029499, vocab_cro_loss : 2.296839, 
epoch   7 summary: train_cos_loss : 0.024629, vocab_cro_loss : 2.157677, 
epoch   8 summary: train_cos_loss : 0.020797, vocab_cro_loss : 2.063742, 
epoch   9 summary: train_cos_loss : 0.017897, vocab_cro_loss : 1.986793, 
epoch  10 summary: train_cos_loss : 0.015841, vocab_cro_loss : 1.925620, 
train loss: 1.8479, accuracy: 0.5015
epoch  11 summary: train_cos_loss : 0.014161, vocab_cro_loss : 1.847656, 
epoch  12 summary: train_cos_loss : 0.012740, vocab_cro_loss : 1.820920, 
epoch  13 summary: train_cos_loss : 0.011686, vocab_cro_loss : 1.877903, 
epoch  14 summary: train_cos_loss : 0.010753, vocab_cro_loss : 1.869229, 
epoch  15 summary: train_cos_loss : 0.010066, vocab_cro_loss : 1.885539, 
epoch  16 summary: train_cos_loss : 0.009448, vocab_cro_loss : 1.865953, 
epoch  17 summary: train_cos_loss : 0.009030, vocab_cro_loss : 1.861255, 
epoch  18 summary: train_cos_loss : 0.008743, vocab_cro_loss : 2.019492, 
epoch  19 summary: train_cos_loss : 0.008358, vocab_cro_loss : 1.886437, 
epoch  20 summary: train_cos_loss : 0.008134, vocab_cro_loss : 2.225837, 
train loss: 1.9740, accuracy: 0.4868
epoch  21 summary: train_cos_loss : 0.007932, vocab_cro_loss : 1.973187, 
epoch  22 summary: train_cos_loss : 0.007675, vocab_cro_loss : 2.081402, 
epoch  23 summary: train_cos_loss : 0.007609, vocab_cro_loss : 2.152693, 
epoch  24 summary: train_cos_loss : 0.007417, vocab_cro_loss : 2.035685, 
epoch  25 summary: train_cos_loss : 0.007157, vocab_cro_loss : 1.985894, 
epoch  26 summary: train_cos_loss : 0.007023, vocab_cro_loss : 1.985871, 
epoch  27 summary: train_cos_loss : 0.006951, vocab_cro_loss : 2.008184, 
epoch  28 summary: train_cos_loss : 0.006879, vocab_cro_loss : 2.002665, 
epoch  29 summary: train_cos_loss : 0.006790, vocab_cro_loss : 1.939400, 
epoch  30 summary: train_cos_loss : 0.006758, vocab_cro_loss : 1.910955, 
train loss: 1.9012, accuracy: 0.4829
epoch  31 summary: train_cos_loss : 0.006644, vocab_cro_loss : 1.900435, 
epoch  32 summary: train_cos_loss : 0.006551, vocab_cro_loss : 1.937984, 
epoch  33 summary: train_cos_loss : 0.006529, vocab_cro_loss : 1.963712, 
epoch  34 summary: train_cos_loss : 0.006437, vocab_cro_loss : 1.979779, 
epoch  35 summary: train_cos_loss : 0.006363, vocab_cro_loss : 1.950007, 
epoch  36 summary: train_cos_loss : 0.006309, vocab_cro_loss : 1.935528, 
epoch  37 summary: train_cos_loss : 0.006214, vocab_cro_loss : 1.896514, 
epoch  38 summary: train_cos_loss : 0.006112, vocab_cro_loss : 1.851797, 
epoch  39 summary: train_cos_loss : 0.006058, vocab_cro_loss : 1.897464, 
epoch  40 summary: train_cos_loss : 0.005998, vocab_cro_loss : 1.979206, 
train loss: 2.0657, accuracy: 0.4905
epoch  41 summary: train_cos_loss : 0.006029, vocab_cro_loss : 2.064621, 
epoch  42 summary: train_cos_loss : 0.005976, vocab_cro_loss : 2.154391, 
epoch  43 summary: train_cos_loss : 0.006001, vocab_cro_loss : 1.923532, 
epoch  44 summary: train_cos_loss : 0.005946, vocab_cro_loss : 1.911906, 
epoch  45 summary: train_cos_loss : 0.005911, vocab_cro_loss : 1.859499, 
epoch  46 summary: train_cos_loss : 0.005863, vocab_cro_loss : 1.846415, 
epoch  47 summary: train_cos_loss : 0.005825, vocab_cro_loss : 1.781411, 
epoch  48 summary: train_cos_loss : 0.005780, vocab_cro_loss : 1.797837, 
epoch  49 summary: train_cos_loss : 0.005834, vocab_cro_loss : 1.753780, 
epoch  50 summary: train_cos_loss : 0.005883, vocab_cro_loss : 1.778175, 
train loss: 1.7079, accuracy: 0.5273
epoch  51 summary: train_cos_loss : 0.005858, vocab_cro_loss : 1.707654, 
epoch  52 summary: train_cos_loss : 0.005795, vocab_cro_loss : 1.663214, 
epoch  53 summary: train_cos_loss : 0.005728, vocab_cro_loss : 1.685735, 
epoch  54 summary: train_cos_loss : 0.005676, vocab_cro_loss : 1.664851, 
epoch  55 summary: train_cos_loss : 0.005733, vocab_cro_loss : 1.706424, 
epoch  56 summary: train_cos_loss : 0.005681, vocab_cro_loss : 1.704017, 
epoch  57 summary: train_cos_loss : 0.005675, vocab_cro_loss : 1.895745, 
epoch  58 summary: train_cos_loss : 0.005747, vocab_cro_loss : 1.843486, 
epoch  59 summary: train_cos_loss : 0.005704, vocab_cro_loss : 1.785472, 
epoch  60 summary: train_cos_loss : 0.005693, vocab_cro_loss : 1.724391, 
train loss: 1.7500, accuracy: 0.5142
epoch  61 summary: train_cos_loss : 0.005653, vocab_cro_loss : 1.749230, 
epoch  62 summary: train_cos_loss : 0.005703, vocab_cro_loss : 1.857388, 
epoch  63 summary: train_cos_loss : 0.005659, vocab_cro_loss : 1.830217, 
epoch  64 summary: train_cos_loss : 0.005613, vocab_cro_loss : 1.809403, 
epoch  65 summary: train_cos_loss : 0.005680, vocab_cro_loss : 1.774055, 
epoch  66 summary: train_cos_loss : 0.005572, vocab_cro_loss : 1.738864, 
epoch  67 summary: train_cos_loss : 0.005526, vocab_cro_loss : 1.737209, 
epoch  68 summary: train_cos_loss : 0.005577, vocab_cro_loss : 1.792241, 
epoch  69 summary: train_cos_loss : 0.005558, vocab_cro_loss : 1.858913, 
epoch  70 summary: train_cos_loss : 0.005586, vocab_cro_loss : 1.832980, 
train loss: 1.8005, accuracy: 0.5063
epoch  71 summary: train_cos_loss : 0.005617, vocab_cro_loss : 1.799802, 
epoch  72 summary: train_cos_loss : 0.005600, vocab_cro_loss : 1.880919, 
epoch  73 summary: train_cos_loss : 0.005612, vocab_cro_loss : 1.801612, 
epoch  74 summary: train_cos_loss : 0.005525, vocab_cro_loss : 1.722660, 
epoch  75 summary: train_cos_loss : 0.005440, vocab_cro_loss : 1.683581, 
epoch  76 summary: train_cos_loss : 0.005450, vocab_cro_loss : 1.687558, 
epoch  77 summary: train_cos_loss : 0.005523, vocab_cro_loss : 1.695718, 
epoch  78 summary: train_cos_loss : 0.005466, vocab_cro_loss : 1.717512, 
epoch  79 summary: train_cos_loss : 0.005482, vocab_cro_loss : 1.714364, 
epoch  80 summary: train_cos_loss : 0.005545, vocab_cro_loss : 1.715928, 
train loss: 1.7802, accuracy: 0.5256
epoch  81 summary: train_cos_loss : 0.005554, vocab_cro_loss : 1.779203, 
epoch  82 summary: train_cos_loss : 0.005534, vocab_cro_loss : 1.743072, 
epoch  83 summary: train_cos_loss : 0.005486, vocab_cro_loss : 1.849833, 
epoch  84 summary: train_cos_loss : 0.005465, vocab_cro_loss : 1.780397, 
epoch  85 summary: train_cos_loss : 0.005569, vocab_cro_loss : 1.811208, 
epoch  86 summary: train_cos_loss : 0.005650, vocab_cro_loss : 1.822212, 
epoch  87 summary: train_cos_loss : 0.005663, vocab_cro_loss : 1.855094, 
epoch  88 summary: train_cos_loss : 0.005686, vocab_cro_loss : 1.773285, 
epoch  89 summary: train_cos_loss : 0.005609, vocab_cro_loss : 1.802962, 
epoch  90 summary: train_cos_loss : 0.005716, vocab_cro_loss : 1.841492, 
train loss: 1.8456, accuracy: 0.5171
epoch  91 summary: train_cos_loss : 0.005643, vocab_cro_loss : 1.844776, 
epoch  92 summary: train_cos_loss : 0.005657, vocab_cro_loss : 1.860021, 
epoch  93 summary: train_cos_loss : 0.005584, vocab_cro_loss : 1.786292, 
epoch  94 summary: train_cos_loss : 0.005619, vocab_cro_loss : 1.783689, 
epoch  95 summary: train_cos_loss : 0.005557, vocab_cro_loss : 1.697906, 
epoch  96 summary: train_cos_loss : 0.005553, vocab_cro_loss : 1.830014, 
epoch  97 summary: train_cos_loss : 0.005618, vocab_cro_loss : 1.782003, 
epoch  98 summary: train_cos_loss : 0.005530, vocab_cro_loss : 1.760568, 
epoch  99 summary: train_cos_loss : 0.005508, vocab_cro_loss : 1.805158, 
train loss: 1.8372, accuracy: 0.5010
all                         193078.876ms
all_epoch                   190398.418ms
all_preparation               2680.428ms
all_preparation_2             2678.189ms
all_preparation_3                2.206ms
epoch                         1764.432ms
epoch_pos_train                  3.306ms
epoch_preparation               16.426ms
epoch_train                   1730.180ms
epoch_valid                     13.513ms
----------------------------------------
all                         193078.876ms
  all_epoch             98.61%
  all_preparation        1.39%
all_preparation               2680.428ms
  all_preparation_2     99.92%
  all_preparation_3      0.08%
epoch                       176443.222ms
  epoch_train           98.06%
  epoch_preparation      0.93%
  epoch_valid            0.77%
  epoch_pos_train        0.19%
epoch   0 summary: valid_cos_loss : 0.166734, 
valid loss: 3.4652, accuracy: 0.1675
epoch   1 summary: valid_cos_loss : 0.105900, 
epoch   2 summary: valid_cos_loss : 0.071569, 
epoch   3 summary: valid_cos_loss : 0.050560, 
epoch   4 summary: valid_cos_loss : 0.037255, 
epoch   5 summary: valid_cos_loss : 0.028936, 
epoch   6 summary: valid_cos_loss : 0.023635, 
epoch   7 summary: valid_cos_loss : 0.020030, 
epoch   8 summary: valid_cos_loss : 0.017562, 
epoch   9 summary: valid_cos_loss : 0.015911, 
epoch  10 summary: valid_cos_loss : 0.014961, 
valid loss: 2.3071, accuracy: 0.4198
epoch  11 summary: valid_cos_loss : 0.013984, 
epoch  12 summary: valid_cos_loss : 0.013286, 
epoch  13 summary: valid_cos_loss : 0.012797, 
epoch  14 summary: valid_cos_loss : 0.012427, 
epoch  15 summary: valid_cos_loss : 0.012094, 
epoch  16 summary: valid_cos_loss : 0.011861, 
epoch  17 summary: valid_cos_loss : 0.011694, 
epoch  18 summary: valid_cos_loss : 0.011519, 
epoch  19 summary: valid_cos_loss : 0.011345, 
epoch  20 summary: valid_cos_loss : 0.011432, 
valid loss: 2.2787, accuracy: 0.4314
epoch  21 summary: valid_cos_loss : 0.011290, 
epoch  22 summary: valid_cos_loss : 0.011186, 
epoch  23 summary: valid_cos_loss : 0.011164, 
epoch  24 summary: valid_cos_loss : 0.011041, 
epoch  25 summary: valid_cos_loss : 0.011007, 
epoch  26 summary: valid_cos_loss : 0.010910, 
epoch  27 summary: valid_cos_loss : 0.010834, 
epoch  28 summary: valid_cos_loss : 0.010785, 
epoch  29 summary: valid_cos_loss : 0.010740, 
epoch  30 summary: valid_cos_loss : 0.010856, 
valid loss: 2.2709, accuracy: 0.4347
epoch  31 summary: valid_cos_loss : 0.010823, 
epoch  32 summary: valid_cos_loss : 0.010774, 
epoch  33 summary: valid_cos_loss : 0.010720, 
epoch  34 summary: valid_cos_loss : 0.010698, 
epoch  35 summary: valid_cos_loss : 0.010679, 
epoch  36 summary: valid_cos_loss : 0.010664, 
epoch  37 summary: valid_cos_loss : 0.010663, 
epoch  38 summary: valid_cos_loss : 0.010609, 
epoch  39 summary: valid_cos_loss : 0.010562, 
epoch  40 summary: valid_cos_loss : 0.010636, 
valid loss: 2.2626, accuracy: 0.4364
epoch  41 summary: valid_cos_loss : 0.010635, 
epoch  42 summary: valid_cos_loss : 0.010637, 
epoch  43 summary: valid_cos_loss : 0.010594, 
epoch  44 summary: valid_cos_loss : 0.010576, 
epoch  45 summary: valid_cos_loss : 0.010573, 
epoch  46 summary: valid_cos_loss : 0.010494, 
epoch  47 summary: valid_cos_loss : 0.010501, 
epoch  48 summary: valid_cos_loss : 0.010488, 
epoch  49 summary: valid_cos_loss : 0.010451, 
epoch  50 summary: valid_cos_loss : 0.010535, 
valid loss: 2.2552, accuracy: 0.4363
epoch  51 summary: valid_cos_loss : 0.010504, 
epoch  52 summary: valid_cos_loss : 0.010464, 
epoch  53 summary: valid_cos_loss : 0.010431, 
epoch  54 summary: valid_cos_loss : 0.010414, 
epoch  55 summary: valid_cos_loss : 0.010421, 
epoch  56 summary: valid_cos_loss : 0.010423, 
epoch  57 summary: valid_cos_loss : 0.010371, 
epoch  58 summary: valid_cos_loss : 0.010375, 
epoch  59 summary: valid_cos_loss : 0.010360, 
epoch  60 summary: valid_cos_loss : 0.010468, 
valid loss: 2.2497, accuracy: 0.4384
epoch  61 summary: valid_cos_loss : 0.010422, 
epoch  62 summary: valid_cos_loss : 0.010357, 
epoch  63 summary: valid_cos_loss : 0.010346, 
epoch  64 summary: valid_cos_loss : 0.010338, 
epoch  65 summary: valid_cos_loss : 0.010340, 
epoch  66 summary: valid_cos_loss : 0.010273, 
epoch  67 summary: valid_cos_loss : 0.010280, 
epoch  68 summary: valid_cos_loss : 0.010259, 
epoch  69 summary: valid_cos_loss : 0.010241, 
epoch  70 summary: valid_cos_loss : 0.010369, 
valid loss: 2.2557, accuracy: 0.4369
epoch  71 summary: valid_cos_loss : 0.010323, 
epoch  72 summary: valid_cos_loss : 0.010301, 
epoch  73 summary: valid_cos_loss : 0.010295, 
epoch  74 summary: valid_cos_loss : 0.010295, 
epoch  75 summary: valid_cos_loss : 0.010287, 
epoch  76 summary: valid_cos_loss : 0.010261, 
epoch  77 summary: valid_cos_loss : 0.010268, 
epoch  78 summary: valid_cos_loss : 0.010264, 
epoch  79 summary: valid_cos_loss : 0.010228, 
epoch  80 summary: valid_cos_loss : 0.010321, 
valid loss: 2.2547, accuracy: 0.4375
epoch  81 summary: valid_cos_loss : 0.010279, 
epoch  82 summary: valid_cos_loss : 0.010250, 
epoch  83 summary: valid_cos_loss : 0.010256, 
epoch  84 summary: valid_cos_loss : 0.010262, 
epoch  85 summary: valid_cos_loss : 0.010239, 
epoch  86 summary: valid_cos_loss : 0.010206, 
epoch  87 summary: valid_cos_loss : 0.010170, 
epoch  88 summary: valid_cos_loss : 0.010190, 
epoch  89 summary: valid_cos_loss : 0.010198, 
epoch  90 summary: valid_cos_loss : 0.010291, 
valid loss: 2.2590, accuracy: 0.4366
epoch  91 summary: valid_cos_loss : 0.010237, 
epoch  92 summary: valid_cos_loss : 0.010214, 
epoch  93 summary: valid_cos_loss : 0.010182, 
epoch  94 summary: valid_cos_loss : 0.010199, 
epoch  95 summary: valid_cos_loss : 0.010193, 
epoch  96 summary: valid_cos_loss : 0.010181, 
epoch  97 summary: valid_cos_loss : 0.010176, 
epoch  98 summary: valid_cos_loss : 0.010161, 
epoch  99 summary: valid_cos_loss : 0.010161, 
valid loss: 2.2621, accuracy: 0.4368
all                         309227.592ms
all_epoch                   309215.249ms
all_preparation                 12.304ms
all_preparation_2               10.831ms
all_preparation_3                1.454ms
epoch                         3017.674ms
epoch_pos_train                  4.096ms
epoch_preparation                0.448ms
epoch_train                   2980.593ms
epoch_valid                     31.922ms
----------------------------------------
all                         309227.592ms
  all_epoch            100.00%
  all_preparation        0.00%
all_preparation                 12.304ms
  all_preparation_2     88.03%
  all_preparation_3     11.82%
epoch                       301767.393ms
  epoch_train           98.77%
  epoch_valid            1.06%
  epoch_pos_train        0.14%
  epoch_preparation      0.01%
